<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>å¸•å¸•&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="å¥‹æ–—ä¸­çš„ç¨‹åºå‘˜ã€‚">
<meta property="og:type" content="website">
<meta property="og:title" content="å¸•å¸•&#39;s Blog">
<meta property="og:url" content="https://hparis.github.io/blog/index.html">
<meta property="og:site_name" content="å¸•å¸•&#39;s Blog">
<meta property="og:description" content="å¥‹æ–—ä¸­çš„ç¨‹åºå‘˜ã€‚">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="å¸•å¸•&#39;s Blog">
<meta name="twitter:description" content="å¥‹æ–—ä¸­çš„ç¨‹åºå‘˜ã€‚">
    

    
        <link rel="alternate" href="/" title="å¸•å¸•&#39;s Blog" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/blog/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/blog/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/blog/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/blog/css/style.css">

    <script src="/blog/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/blog/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/blog/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/blog/" id="logo">
                <i class="logo"></i>
                <span class="site-title">å¸•å¸•&#39;s Blog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/blog/.">Home</a>
                
                    <a class="main-nav-link" href="/blog/archives">Archives</a>
                
                    <a class="main-nav-link" href="/blog/categories">Categories</a>
                
                    <a class="main-nav-link" href="/blog/tags">Tags</a>
                
                    <a class="main-nav-link" href="/blog/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/blog/css/images/avatar.png" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/blog/',
        CONTENT_URL: '/blog/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/blog/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/blog/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/blog/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/blog/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/blog/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/blog/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/blog/css/images/avatar.png" />
            <h2 id="name">å¸•å¸•</h2>
            <h3 id="title">iOS Developer &amp; RN</h3>
            <span id="location"><i class="fa fa-map-marker"></i>Beijing, China</span>
            <a id="follow" target="_blank" href="https://github.com/HParis">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                15
                <span>posts</span>
            </div>
            <div class="article-info-block">
                11
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/HParis" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://twitter.com/Paris_Htj" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://www.facebook.com/profile.php?id=100006030375941" target="_blank" title="facebook" class=tooltip>
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/blog/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/blog/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main">
    <article id="post-Swift-High-Performance-Tip 3ï¼š @objc-å’Œ-dynamic" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2018/05/25/Swift-High-Performance-Tip 3ï¼š @objc-å’Œ-dynamic/">Swift High-Performance Tip 3ï¼š@objc å’Œ dynamic</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2018/05/25/Swift-High-Performance-Tip 3ï¼š @objc-å’Œ-dynamic/">
            <time datetime="2018-05-24T18:48:01.000Z" itemprop="datePublished">2018-05-24</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/Swift/">Swift</a>, <a class="tag-link" href="/blog/tags/iOS/">iOS</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h3 id="objc"><a href="#objc" class="headerlink" title="@objc"></a>@objc</h3><p>@objc çš„ä½œç”¨æ˜¯ä¸ºäº†è®© Objective-C èƒ½å¤Ÿè°ƒç”¨ Swift çš„ä»£ç ã€‚å…¶ä¸­çš„å…³é”®æ˜¯ @objc ä¼šç”Ÿæˆä¸€æ®µ thunk ä»£ç ï¼ŒObjective-C é€šè¿‡è¿™æ®µ thunk ä»£ç æ¥é—´æ¥è°ƒç”¨ Swift ä»£ç ã€‚å¦‚æœæ˜¯ Swift æ¥è°ƒç”¨è¢« @objc ä¿®é¥°çš„æ–¹æ³•çš„æ—¶å€™ï¼Œæ­¤æ—¶æ˜¯ä¸éœ€è¦ç»è¿‡ thunk ä»£ç å°±èƒ½ç›´æ¥è°ƒç”¨çš„ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œå¦‚æœæ–¹æ³•å˜å¾—å¤æ‚æˆ–è€…è¢« @objc ä¿®é¥°çš„æ–¹æ³•æ•°é‡å˜å¾—è¶Šæ¥è¶Šå¤šä¼šå‘ç”Ÿä»€ä¹ˆäº‹ï¼Ÿç­”æ¡ˆå°±æ˜¯ thunk ä»£ç å˜å¾—è¶Šæ¥è¶Šå¤šï¼Œæœ€åä¼šå¯¼è‡´æˆ‘ä»¬çš„åŒ…å¤§å°ä¹Ÿå˜å¾—è¶Šæ¥è¶Šå¤§ã€‚å¹¶ä¸”åŠ¨æ€é“¾æ¥å™¨ï¼ˆdynamic linkerï¼‰è¿˜éœ€è¦æ•´ç†è¿™äº› thunk ä»£ç ï¼Œæœ€åå¯¼è‡´åŠ è½½æ—¶é—´ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šé•¿ã€‚</p>
<p>åœ¨ Swift3 çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šæ¨æ–­å‡ºä½ çš„æ–¹æ³•ä¸æ˜¯ Swift ä¸“ç”¨çš„ï¼ˆæ¯”å¦‚æœ‰å…ƒç»„ã€ç»“æ„ä½“ï¼‰ï¼Œå°±ä¼šé»˜è®¤ç»™ä½ çš„æ–¹æ³•å¢åŠ  @objc çš„ä¿®é¥°ã€‚è¿™ç§æ–¹å¼å°±å¯¼è‡´äº†åœ¨ Swift3 çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆå¤§é‡çš„ thunk ä»£ç ï¼Œå¹¶ä¸”è¿™å…¶ä¸­çš„å¤§éƒ¨åˆ†ä»£ç éƒ½ä¸ä¼šè¢«ä½¿ç”¨ã€‚æ‰€ä»¥ Swift4 é»˜è®¤æ˜¯ä¸åš @objc çš„æ¨æ–­ï¼Œåªæœ‰æˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ äº† @objc ä¹‹åï¼ŒObjective-C æ‰èƒ½è°ƒç”¨æˆ‘ä»¬çš„ Swift ä»£ç ã€‚ </p>
<h3 id="dynamic"><a href="#dynamic" class="headerlink" title="dynamic"></a>dynamic</h3><p>Swift çš„æ–¹æ³•æ˜¯é€šè¿‡ vtable æ¥è°ƒç”¨çš„ï¼Œä½¿ç”¨ vtable çš„è¦æ¯” Objective-C çš„ runtime æ›´é«˜æ•ˆã€‚</p>
<p>è€Œä½¿ç”¨ dynamic æ¥ä¿®é¥°çš„æ–¹æ³•ï¼Œä»£è¡¨è¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥è¢«åŠ¨æ€è°ƒç”¨çš„ã€‚è€Œç”±äºç›®å‰ Swfit è¿˜æ²¡æœ‰æ—¶é—´è‡ªå·±çš„ runtime æœºåˆ¶ï¼Œæ‰€ä»¥åŠ¨æ€è°ƒç”¨åªèƒ½å¤Ÿåœ¨ Objective-C å»è°ƒç”¨ã€‚åœ¨  Swift4 ä½¿ç”¨ dynamic ä¿®é¥°ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šè¦æ±‚ä½ è¿˜éœ€è¦ä½¿ç”¨ @objc å»ä¿®é¥°ã€‚è¿™æ˜¯ä¸ºäº†æ˜ç¡®çš„å‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªæ–¹æ³•æ˜¯ç”± Objective-C çš„ runtime æ¥è°ƒç”¨çš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†å…¼å®¹ä»¥åå¯èƒ½ä¼šå‡ºç°çš„ Swift runtime æœºåˆ¶ã€‚</p>
<p>ç”±äºç›®å‰ä½¿ç”¨ @objc dynamic ä¿®é¥°çš„æ–¹æ³•å¹¶ä¸åœ¨ Swift å®ä¾‹å¯¹è±¡çš„ vtable é‡Œé¢ï¼Œæ‰€ä»¥ Swift æ¥è°ƒç”¨è¯¥æ–¹æ³•çš„æ—¶å€™ä¾æ—§éœ€è¦é€šè¿‡ thunk ä»£ç æ¥è°ƒç”¨ã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><img src="https://swiftunboxed.com/images/native-objc-dynamic.png" alt="æ­¤å›¾å‡ºè‡ª https://swiftunboxed.com/interop/objc-dynamic/"></p>
<p>é€šè¿‡ä¸Šå›¾æˆ‘ä»¬çŸ¥é“ï¼š</p>
<blockquote>
<p>é™¤éæ˜ç¡®çš„çŸ¥é“ä¼šåœ¨ Objective-C ä¸­è°ƒç”¨è¿™æ®µä»£ç ï¼Œå¦åˆ™åˆ«ä½¿ç”¨ @objc<br>é™¤éæ˜ç¡®çš„çŸ¥é“è¯¥æ–¹æ³•éœ€è¦è¢« Objective-C çš„ runtime åŠ¨æ€è°ƒç”¨ï¼Œå¦åˆ™åˆ«ä½¿ç”¨ @objc dynamic</p>
</blockquote>
<hr>
<p><strong>å‚è€ƒæ–‡çŒ®</strong></p>
<ol>
<li><p><a href="https://swiftunboxed.com/interop/objc-dynamic/" target="_blank" rel="noopener">https://swiftunboxed.com/interop/objc-dynamic/</a></p>
</li>
<li><p><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0160-objc-inference.md" target="_blank" rel="noopener">https://github.com/apple/swift-evolution/blob/master/proposals/0160-objc-inference.md</a></p>
</li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2018/05/25/Swift-High-Performance-Tip 3ï¼š @objc-å’Œ-dynamic/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2018/05/25/Swift-High-Performance-Tip 3ï¼š @objc-å’Œ-dynamic/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-self-åœ¨-block-ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2018/04/19/self-åœ¨-block-ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–/">self åœ¨ block ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2018/04/19/self-åœ¨-block-ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–/">
            <time datetime="2018-04-19T11:34:51.000Z" itemprop="datePublished">2018-04-19</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/Block/">Block</a>, <a class="tag-link" href="/blog/tags/Objective-C/">Objective-C</a>, <a class="tag-link" href="/blog/tags/iOS/">iOS</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>ç›¸ä¿¡å¤§å®¶åœ¨ Objective-C ä¸­éƒ½ä¼šé€šè¿‡ <code>__waek</code> çš„ä¿®é¥°ç¬¦æ¥ä¿è¯ block å’Œ self ä¸ä¼šäº’ç›¸å¼•ç”¨ï¼Œä»£ç å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__weak typeof(self) weakSelf = self;</span><br><span class="line">self.block = ^&#123;</span><br><span class="line">    __strong typeof(self) strongSelf = self;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ä½ æ€è€ƒè¿‡ self åœ¨è¿™ä¸€æ®µæ—…ç¨‹ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–ä¹ˆï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šé€šè¿‡ä¸‰ä¸ªä¾‹å­æ¥å±•ç¤ºè¿™ä¸€æ®µæ—…ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// ğŸŒ°1</span><br><span class="line">NSLog(@&quot;Before blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(self)));</span><br><span class="line">self.block = ^&#123;</span><br><span class="line">    self;</span><br><span class="line">    NSLog(@&quot;Within blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(self)));</span><br><span class="line">&#125;;</span><br><span class="line">self.block();</span><br><span class="line">NSLog(@&quot;After blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(self)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ğŸŒ°2</span><br><span class="line">__weak typeof(self) weakSelf = self;</span><br><span class="line">NSLog(@&quot;Before blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(self)));</span><br><span class="line">self.block = ^&#123;</span><br><span class="line">    weakSelf;</span><br><span class="line">    NSLog(@&quot;Within blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(weakSelf)));</span><br><span class="line">&#125;;</span><br><span class="line">self.block();</span><br><span class="line">NSLog(@&quot;After blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(self)));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ğŸŒ°3</span><br><span class="line">__weak typeof(self) weakSelf = self;</span><br><span class="line">NSLog(@&quot;Before blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(self)));</span><br><span class="line">self.block = ^&#123;</span><br><span class="line">    __strong typeof(self) strongSelf = weakSelf;</span><br><span class="line">    NSLog(@&quot;Within blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(weakSelf)));</span><br><span class="line">&#125;;</span><br><span class="line">self.block();</span><br><span class="line">NSLog(@&quot;After blockï¼š%ld&quot;, CFGetRetainCount((__bridge CFTypeRef)(self)));</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ Clang å¯¹ä¸Šé¢çš„ä¸‰ä¸ªä¾‹å­åšä¸€ä¸‹ç¼–è¯‘ï¼Œé€šè¿‡ç¼–è¯‘åçš„ C ä»£ç ï¼ˆæ¥ä¸‹æ¥æ‰€å±•ç¤ºä»£ç éƒ½æ˜¯ç»è¿‡ç®€åŒ–ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡º self çš„å¼•ç”¨è®¡æ•°å˜åŒ–ã€‚</p>
<hr>
<p>ğŸŒ°1 çš„ C ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">// Block ç»“æ„ä½“ã€‚è¿™ä¸ªå¤§å®¶å¯ä»¥é€šè¿‡å…¶ä»–çš„èµ„æ–™å»çœ‹çœ‹ï¼Œæˆ‘ä»¬ä»Šå¤©ä¸»è¦æ˜¯æ¥æ¢å¯»ä¸€ä¸‹ self çš„æ—…ç¨‹ï¼Œè¿™é‡Œå°±ä¸å¯¹ Block æœ¬èº«åšæ›´è¯¦ç»†çš„ä»‹ç»</span><br><span class="line">struct __block_impl &#123;</span><br><span class="line">  void *isa;</span><br><span class="line">  int Flags;</span><br><span class="line">  int Reserved;</span><br><span class="line">  void *FuncPtr;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// ^&#123;&#125; çš„å®ç°</span><br><span class="line">struct __BlockTest__test_block_impl_0 &#123;</span><br><span class="line">    struct __block_impl impl;</span><br><span class="line">    struct __BlockTest__test_block_desc_0* Desc;</span><br><span class="line">    BlockTest *const __strong self;</span><br><span class="line">    __BlockTest__test_block_impl_0(void *fp, struct __BlockTest__test_block_desc_0 *desc, BlockTest *const __strong _self, int flags=0) : self(_self) &#123;</span><br><span class="line">        impl.isa = &amp;_NSConcreteStackBlock;</span><br><span class="line">        impl.Flags = flags;</span><br><span class="line">        impl.FuncPtr = fp;</span><br><span class="line">        Desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Block æ–¹æ³•</span><br><span class="line">static void __BlockTest__test_block_func_0(struct __BlockTest__test_block_impl_0 *__cself) &#123;</span><br><span class="line">    BlockTest *const __strong self = __cself-&gt;self; // bound by copy</span><br><span class="line">    self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Block çš„ copy æ“ä½œ</span><br><span class="line">static void __BlockTest__test_block_copy_0(struct __BlockTest__test_block_impl_0*dst, struct __BlockTest__test_block_impl_0*src) &#123;_Block_object_assign((void*)&amp;dst-&gt;self, (void*)src-&gt;self, 3/*BLOCK_FIELD_IS_OBJECT*/);&#125;</span><br><span class="line"></span><br><span class="line">// Block çš„ dispose æ“ä½œ</span><br><span class="line">static void __BlockTest__test_block_dispose_0(struct __BlockTest__test_block_impl_0*src) &#123;_Block_object_dispose((void*)src-&gt;self, 3/*BLOCK_FIELD_IS_OBJECT*/);&#125;</span><br><span class="line"></span><br><span class="line">// æè¿° Block çš„ copy å’Œ dispose</span><br><span class="line">static struct __BlockTest__test_block_desc_0 &#123;</span><br><span class="line">    size_t reserved;</span><br><span class="line">    size_t Block_size;</span><br><span class="line">    void (*copy)(struct __BlockTest__test_block_impl_0*, struct __BlockTest__test_block_impl_0*);</span><br><span class="line">    void (*dispose)(struct __BlockTest__test_block_impl_0*);</span><br><span class="line">&#125; __BlockTest__test_block_desc_0_DATA = &#123; 0, sizeof(struct __BlockTest__test_block_impl_0), __BlockTest__test_block_copy_0, __BlockTest__test_block_dispose_0&#125;;</span><br><span class="line"></span><br><span class="line">// æ–¹æ³•ä¸»ä½“</span><br><span class="line">static void _I_BlockTest_test(BlockTest * self, SEL _cmd) &#123;</span><br><span class="line">    ((void (*)(id, SEL, void (*)()))(void *)objc_msgSend)((id)self, sel_registerName(&quot;setBlock:&quot;), ((void (*)())&amp;__BlockTest__test_block_impl_0((void *)__BlockTest__test_block_func_0, &amp;__BlockTest__test_block_desc_0_DATA, self, 570425344)));</span><br><span class="line">    ((void (*(*)(id, SEL))())(void *)objc_msgSend)((id)self, sel_registerName(&quot;block&quot;))();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>åœ¨æ–¹æ³•ä¸»ä½“é‡Œé¢é¦–å…ˆä¼šæ„é€ ä¸€ä¸ª <code>__BlockTest__test_block_impl_0</code> çš„ç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“æ•è·äº† selfï¼›</li>
<li><code>__BlockTest__test_block_impl_0</code> çš„æ„é€ å‡½æ•°ä¸­ä½¿ç”¨äº† <code>__strong</code> æ¥æ•è· selfï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“åœ¨æ„é€ çš„æ—¶å€™é»˜è®¤æ˜¯ä½¿ç”¨ <code>__strong</code> æ¥æ•è·å¤–éƒ¨çš„å¯¹è±¡å˜é‡ï¼Œæ­¤æ—¶ self çš„å¼•ç”¨è®¡æ•°åº”è¯¥è¦ +1ï¼›</li>
<li>Block è¢«æ„é€ å‡ºæ¥ä¹‹åéœ€è¦è¢«èµ‹å€¼ç»™ selfï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ ARC æ¨¡å¼ä¸‹æ­¤æ—¶çš„ Block ä¼šæ‰§è¡Œ Copy æ“ä½œï¼Œä» <code>_NSConcreteStackBlock</code> å˜æˆ <code>_NSMallocBlock</code>ï¼›</li>
<li>Block é€šè¿‡ <code>__BlockTest__test_block_desc_0_DATA</code> æ‰¾åˆ° Copy æ–¹æ³•çš„å…·ä½“å®ç° <code>__BlockTest__test_block_copy_0</code>ï¼Œä»ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬çŸ¥é“è¯¥æ–¹æ³•çš„å®ç°æ˜¯é€šè¿‡ <code>_Block_object_assign</code> æ¥å®ç°çš„ï¼ˆå¯¹äºè¿™ä¸ªæ–¹æ³•çš„å®ç°ç»†èŠ‚æš‚æ—¶è¿˜æ²¡æœ‰æ‰¾åˆ°æ›´ç›¸ä¿¡çš„èµ„æ–™ï¼Œæœ‰çŸ¥é“çš„å¯ä»¥éº»çƒ¦å‘Šè¯‰ä¸€ä¸‹ï¼‰ï¼Œé€šè¿‡åå­—æˆ‘ä»¬å¯ä»¥çŒœæµ‹å‡ºè¯¥æ–¹æ³•åªæ˜¯æŠŠæ•è·çš„å˜é‡åœ°å€ç›´æ¥æ‹·è´ä¸€ä»½åˆ°å †å†…å­˜ä¸­ï¼Œä½†æ˜¯ä¸ä¼šå¼•èµ·å¼•ç”¨è®¡æ•°çš„å˜åŒ–ï¼›</li>
<li>å½“ Block è¢«çœŸæ­£æ‰§è¡Œçš„æ—¶å€™ä¼šé€šè¿‡ <code>__block_impl</code> çš„ <code>FuncPtr</code> æ‰¾åˆ°çœŸæ­£çš„å®ç°ä»£ç  <code>__BlockTest__test_block_func_0</code>ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢æœ‰è¿™æ ·ä¸€å¥ä»£ç  <code>BlockTest *const __strong self = __cself-&gt;self</code>ï¼Œå¾ˆæ˜æ˜¾æ­¤æ—¶ self çš„å¼•ç”¨è®¡æ•°ä¼š +1ï¼Œå½“è¯¥ <code>__BlockTest__test_block_func_0</code> æ‰§è¡Œå®Œæ¯•ä¹‹åè¿˜æ˜¯ä¼šé‡Šæ”¾ self çš„ï¼Œæ­¤æ—¶å¼•ç”¨è®¡æ•°ä¼š -1ï¼›</li>
</ol>
<p>ä»ä¸Šé¢çš„åˆ†æè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ç”±äº Block åœ¨æ„é€ çš„æ—¶å€™é»˜è®¤å°±å¯¹æ•è·çš„ self è¿›è¡Œäº†å¼ºå¼•ç”¨ï¼Œå¯¼è‡´ self çš„å¼•ç”¨è®¡æ•° +1ï¼›è€Œåˆç”±äº self æŒæœ‰äº† Blockï¼Œæ‰€ä»¥è¿™é‡Œå°±é€ æˆäº†å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ ğŸŒ°2 èƒ½ä¸èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ</p>
<hr>
<p>ğŸŒ°2 çš„ C ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">// ^&#123;&#125; ç»“æ„ä½“</span><br><span class="line">struct __BlockTest__test_block_impl_0 &#123;</span><br><span class="line">    struct __block_impl impl;</span><br><span class="line">    struct __BlockTest__test_block_desc_0* Desc;</span><br><span class="line">    BlockTest *const __weak weakSelf;</span><br><span class="line">    __BlockTest__test_block_impl_0(void *fp, struct __BlockTest__test_block_desc_0 *desc, BlockTest *const __weak _weakSelf, int flags=0) : weakSelf(_weakSelf) &#123;</span><br><span class="line">        impl.isa = &amp;_NSConcreteStackBlock;</span><br><span class="line">        impl.Flags = flags;</span><br><span class="line">        impl.FuncPtr = fp;</span><br><span class="line">        Desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Block æ–¹æ³•</span><br><span class="line">static void __BlockTest__test_block_func_0(struct __BlockTest__test_block_impl_0 *__cself) &#123;</span><br><span class="line">    BlockTest *const __weak weakSelf = __cself-&gt;weakSelf; // bound by copy</span><br><span class="line">    weakSelf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Block çš„ copy æ“ä½œ</span><br><span class="line">static void __BlockTest__test_block_copy_0(struct __BlockTest__test_block_impl_0*dst, struct __BlockTest__test_block_impl_0*src) &#123;_Block_object_assign((void*)&amp;dst-&gt;weakSelf, (void*)src-&gt;weakSelf, 3/*BLOCK_FIELD_IS_OBJECT*/);&#125;</span><br><span class="line"></span><br><span class="line">// Block çš„ dispose æ“ä½œ</span><br><span class="line">static void __BlockTest__test_block_dispose_0(struct __BlockTest__test_block_impl_0*src) &#123;_Block_object_dispose((void*)src-&gt;weakSelf, 3/*BLOCK_FIELD_IS_OBJECT*/);&#125;</span><br><span class="line"></span><br><span class="line">// æè¿° Block çš„ copy å’Œ dispose</span><br><span class="line">static struct __BlockTest__test_block_desc_0 &#123;</span><br><span class="line">    size_t reserved;</span><br><span class="line">    size_t Block_size;</span><br><span class="line">    void (*copy)(struct __BlockTest__test_block_impl_0*, struct __BlockTest__test_block_impl_0*);</span><br><span class="line">    void (*dispose)(struct __BlockTest__test_block_impl_0*);</span><br><span class="line">&#125; __BlockTest__test_block_desc_0_DATA = &#123; 0, sizeof(struct __BlockTest__test_block_impl_0), __BlockTest__test_block_copy_0, __BlockTest__test_block_dispose_0&#125;;</span><br><span class="line"></span><br><span class="line">// æ–¹æ³•ä¸»ä½“</span><br><span class="line">static void _I_BlockTest_test(BlockTest * self, SEL _cmd) &#123;</span><br><span class="line">    __attribute__((objc_ownership(weak))) typeof(self) weakSelf = self;</span><br><span class="line">    ((void (*)(id, SEL, void (*)()))(void *)objc_msgSend)((id)self, sel_registerName(&quot;setBlock:&quot;), ((void (*)())&amp;__BlockTest__test_block_impl_0((void *)__BlockTest__test_block_func_0, &amp;__BlockTest__test_block_desc_0_DATA, weakSelf, 570425344)));</span><br><span class="line">    ((void (*(*)(id, SEL))())(void *)objc_msgSend)((id)self, sel_registerName(&quot;block&quot;))();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>æ–¹æ³•ä¸»ä½“ä¼šå…ˆç”¨ <code>__weak</code> åˆå§‹åŒ–ä¸€ä¸ª weakSelfï¼Œæ­¤æ—¶ self çš„å¼•ç”¨è®¡æ•°æ˜¯ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼›ä¹‹åä¼šæ„é€ ä¸€ä¸ª<code>__BlockTest__test_block_impl_0</code> çš„ç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“æ•è·äº† weakSelfï¼›</li>
<li><code>__BlockTest__test_block_impl_0</code> çš„æ„é€ å‡½æ•°ä¸­ä½¿ç”¨äº† <code>__weak</code> æ¥æ•è· weakSelfï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“æ­¤æ—¶ self çš„å¼•ç”¨è®¡æ•°åº”è¯¥è¦ä¹Ÿæ˜¯ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼›</li>
<li>ç„¶åæŠŠè¯¥ç»“æ„ä½“èµ‹å€¼ç»™ self.blockï¼Œblock ç»“æ„ä½“è¢«ä»æ ˆå¤åˆ¶åˆ°å †çš„æ—¶å€™ä½¿ç”¨äº† <code>_Block_object_assign</code>ï¼Œæ‰€ä»¥æ­¤æ—¶ self çš„å¼•ç”¨è®¡æ•°ä¸ä¼šå‘ç”Ÿå˜åŒ–</li>
<li>ç„¶å block åœ¨è¢«æ‰§è¡Œçš„æ—¶å€™åšäº†ä¸€ä¸‹ <code>__weak</code> çš„æ“ä½œ <code>BlockTest *const __weak weakSelf = __cself-&gt;weakSelf</code>ï¼Œè¿™æ—¶å€™ self çš„å¼•ç”¨è®¡æ•°ä¹Ÿä¸ä¼šå‘ç”Ÿå˜åŒ–</li>
<li>ç”±äº block å¯¹ weakSelf æ²¡æœ‰å¼ºå¼•ç”¨ï¼Œæ‰€ä»¥åœ¨ block æ‰§è¡Œå®Œæˆä¹‹åä¹Ÿä¸éœ€è¦åšé‡Šæ”¾ weakSelf çš„å·¥ä½œ</li>
</ol>
<p>æ‰€ä»¥ï¼Œåœ¨è¯¥ä¾‹å­ä¸­ block æ— æ³•å¼ºå¼•ç”¨ weakSelfï¼ŒweakSelf çš„å¼•ç”¨è®¡æ•°æ²¡æœ‰å‘ç”Ÿä»»ä½•å˜åŒ–ã€‚ç”±äº self æ²¡æœ‰è¢« block å¼ºåº”ç”¨ï¼Œæ‰€ä»¥å½“ self è¦è¢«é‡Šæ”¾çš„æ—¶å€™ï¼Œblock ä¹Ÿä¼šè¢«é‡Šæ”¾ï¼Œè¿™å°±è§£å†³äº†æˆ‘ä»¬ ğŸŒ°1 ä¸­çš„å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨ block æ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œself å¯¹è±¡æœ‰å¯èƒ½å·²ç»è¢«é‡Šæ”¾äº†ï¼Œæ­¤æ—¶å¦‚æœä½ è¿˜å»ä½¿ç”¨ weakSelf å°±æœ‰å¯èƒ½é€ æˆå¥”æºƒçš„æƒ…å†µã€‚</p>
<hr>
<p>ğŸŒ°3 çš„ C ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">struct __BlockTest__test_block_impl_0 &#123;</span><br><span class="line">    struct __block_impl impl;</span><br><span class="line">    struct __BlockTest__test_block_desc_0* Desc;</span><br><span class="line">    BlockTest *const __weak weakSelf;</span><br><span class="line">    __BlockTest__test_block_impl_0(void *fp, struct __BlockTest__test_block_desc_0 *desc, BlockTest *const __weak _weakSelf, int flags=0) : weakSelf(_weakSelf) &#123;</span><br><span class="line">        impl.isa = &amp;_NSConcreteStackBlock;</span><br><span class="line">        impl.Flags = flags;</span><br><span class="line">        impl.FuncPtr = fp;</span><br><span class="line">        Desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">static void __BlockTest__test_block_func_0(struct __BlockTest__test_block_impl_0 *__cself) &#123;</span><br><span class="line">    BlockTest *const __weak weakSelf = __cself-&gt;weakSelf; // bound by copy</span><br><span class="line">    __attribute__((objc_ownership(strong))) typeof(self) strongSelf = weakSelf;    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static void __BlockTest__test_block_copy_0(struct __BlockTest__test_block_impl_0*dst, struct __BlockTest__test_block_impl_0*src) &#123;_Block_object_assign((void*)&amp;dst-&gt;weakSelf, (void*)src-&gt;weakSelf, 3/*BLOCK_FIELD_IS_OBJECT*/);&#125;</span><br><span class="line"></span><br><span class="line">static void __BlockTest__test_block_dispose_0(struct __BlockTest__test_block_impl_0*src) &#123;_Block_object_dispose((void*)src-&gt;weakSelf, 3/*BLOCK_FIELD_IS_OBJECT*/);&#125;</span><br><span class="line"></span><br><span class="line">static struct __BlockTest__test_block_desc_0 &#123;</span><br><span class="line">    size_t reserved;</span><br><span class="line">    size_t Block_size;</span><br><span class="line">    void (*copy)(struct __BlockTest__test_block_impl_0*, struct __BlockTest__test_block_impl_0*);</span><br><span class="line">    void (*dispose)(struct __BlockTest__test_block_impl_0*);</span><br><span class="line">&#125; __BlockTest__test_block_desc_0_DATA = &#123; 0, sizeof(struct __BlockTest__test_block_impl_0), __BlockTest__test_block_copy_0, __BlockTest__test_block_dispose_0&#125;;</span><br><span class="line"></span><br><span class="line">static void _I_BlockTest_test(BlockTest * self, SEL _cmd) &#123;</span><br><span class="line">    __attribute__((objc_ownership(weak))) typeof(self) weakSelf = self;</span><br><span class="line">    ((void (*)(id, SEL, void (*)()))(void *)objc_msgSend)((id)self, sel_registerName(&quot;setBlock:&quot;), ((void (*)())&amp;__BlockTest__test_block_impl_0((void *)__BlockTest__test_block_func_0, &amp;__BlockTest__test_block_desc_0_DATA, weakSelf, 570425344)));</span><br><span class="line">    ((void (*(*)(id, SEL))())(void *)objc_msgSend)((id)self, sel_registerName(&quot;block&quot;))();  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‰é¢çš„æ­¥éª¤éƒ½è·Ÿ ğŸŒ°2 ä¸­çš„ä¸€æ ·ï¼Œå…³é”®æ˜¯åœ¨ Block çš„æ–¹æ³•å®ç°é‡Œé¢æœ‰ç‚¹ä¸ä¸€æ ·ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ <code>__BlockTest__test_block_func_0</code>ï¼Œå®ƒé¦–å…ˆè°ƒç”¨äº† <code>BlockTest *const __weak weakSelf = __cself-&gt;weakSelf</code>ï¼Œ æ‰€ä»¥å®ƒæ­¤æ—¶çš„å¼•ç”¨è®¡æ•°ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼›ä½†æ˜¯æ¥ä¸‹æ¥åˆç”¨ <code>objc_ownership(strong)</code> æ¥å¼ºå¼•ç”¨ weakSelfï¼Œæ‰€ä»¥æ­¤æ—¶ self çš„å¼•ç”¨è®¡æ•° +1ã€‚è¿™å°±ä¿è¯äº†åœ¨å‡½æ•°æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒBlock ä¼šä¸€ç›´æŒæœ‰ selfï¼ŒçŸ¥é“ Block æ‰§è¡Œå®Œæ¯•ä¹‹åä¼šé‡Šæ”¾ weakSelfã€‚</p>
<p>æ‰€ä»¥ ğŸŒ°3 å®Œç¾çš„è§£å†³äº†å¾ªç¯åº”ç”¨å’Œç›´æ¥ä½¿ç”¨ <code>__weak</code> å¯èƒ½å¯¼è‡´å¥”æºƒçš„é—®é¢˜ã€‚</p>
<hr>
<p>æœ€åï¼Œè¯´ä¸€ä¸‹å…³äº _Block_object_assign çš„çŒœæƒ³ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_Block_object_assign((void*)&amp;dst-&gt;weakSelf, (void*)src-&gt;weakSelf, 3/*BLOCK_FIELD_IS_OBJECT*/);</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬çŸ¥é“ Block åœ¨æ„é€ çš„æ—¶å€™å°±ä¼šå¯¹æ•è·çš„å˜é‡è¿›è¡Œå†…å­˜ç®¡ç†ï¼ˆå¼ºå¼•ç”¨å’Œå¼±å¼•ç”¨ï¼‰ï¼Œæ‰€ä»¥å½“ Block åœ¨åš Copy æ“ä½œçš„æ—¶å€™å…¶å®æ²¡æœ‰å¿…è¦å¯¹å®ƒæ•è·çš„å˜é‡å†åšä¸€éå†…å­˜ç®¡ç†äº†ã€‚è¿™ä¹Ÿåº”è¯¥æ˜¯ Block çš„ Copy æ“ä½œä½¿ç”¨äº† <code>_Block_object_assign</code> è¿™ç§ä¸ä¼šå¯¼è‡´å¼•ç”¨è®¡æ•°å‘ç”Ÿå˜åŒ–çš„æ–¹å¼æ¥å®ç°çš„åŸå› ã€‚</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2018/04/19/self-åœ¨-block-ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2018/04/19/self-åœ¨-block-ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-å¸¸ç”¨å·¥å…·" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2018/04/09/å¸¸ç”¨å·¥å…·/">å¸¸ç”¨å·¥å…·</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2018/04/09/å¸¸ç”¨å·¥å…·/">
            <time datetime="2018-04-09T02:53:18.333Z" itemprop="datePublished">2018-04-09</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/å…¶ä»–/">å…¶ä»–</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>æ­¤æ–‡ç« æš‚æœªå®Œæˆâ€¦.</p>
</blockquote>
<h1 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h1><h2 id="ç‰ˆæœ¬ç®¡ç†å·¥å…·-rvm"><a href="#ç‰ˆæœ¬ç®¡ç†å·¥å…·-rvm" class="headerlink" title="ç‰ˆæœ¬ç®¡ç†å·¥å…· - rvm"></a>ç‰ˆæœ¬ç®¡ç†å·¥å…· - rvm</h2><ul>
<li><code>$ rvm list</code> åˆ—å‡ºå·²å®‰è£…çš„ ruby ç‰ˆæœ¬</li>
<li><code>$ rvm list kn=own</code> æ˜¾ç¤º local + remote çš„ ruby ç‰ˆæœ¬</li>
<li><code>$ rvm use [ruby-version]</code> å¯ä»¥ä½¿ç”¨ default æ¥æ”¹å˜ç³»ç»Ÿç¯å¢ƒä¸‹çš„ ruby ç‰ˆæœ¬ï¼Œæˆ–ä½¿ç”¨ system æ¥æ”¹å˜å½“å‰ç¯å¢ƒä¸‹çš„ ruby ç‰ˆæœ¬</li>
<li><code>$ rvm remove [ruby-version]</code> åˆ é™¤ ruby ç‰ˆæœ¬</li>
</ul>
<h2 id="åŒ…ç®¡ç†å·¥å…·-gem"><a href="#åŒ…ç®¡ç†å·¥å…·-gem" class="headerlink" title="åŒ…ç®¡ç†å·¥å…· - gem"></a>åŒ…ç®¡ç†å·¥å…· - gem</h2><ul>
<li><code>$ gem install [gem-package]</code> å®‰è£… gem åŒ…</li>
<li><code>$ gem update</code> æ›´æ–° gem åŒ…</li>
<li><code>$ gem update --system</code> æ›´æ–° gem æœ¬èº«</li>
<li><code>$ gem install [gem-package]</code> å®‰è£… gem åŒ…</li>
<li><code>$ gem list</code> åˆ—å‡ºæ‰€æœ‰å®‰è£…çš„ gem åŒ…</li>
<li><code>$ gem remove [gem-package]</code> åˆ é™¤å®‰è£…è¿‡çš„ gem åŒ…</li>
</ul>
<h2 id="å¸¸ç”¨å·¥å…·"><a href="#å¸¸ç”¨å·¥å…·" class="headerlink" title="å¸¸ç”¨å·¥å…·"></a>å¸¸ç”¨å·¥å…·</h2><h3 id="cocoapods"><a href="#cocoapods" class="headerlink" title="cocoapods"></a>cocoapods</h3><ul>
<li><code>gem instal cocoapods</code> å®‰è£… cocoapods</li>
<li><code>pod setup</code> åˆå§‹åŒ– Pod åº“</li>
<li><code>pod repo update</code> æ›´æ–° Pod åº“</li>
<li><code>pod install</code> æ ¹æ®å½“å‰ç›®å½•çš„ Podfile æ–‡ä»¶å®‰è£… Pod åº“</li>
<li><code>pod update</code> æ›´æ–° Podfile æ–‡ä»¶ä¸­çš„ Pod åº“</li>
</ul>
<h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><h2 id="ç‰ˆæœ¬ç®¡ç†å·¥å…·-pyenv"><a href="#ç‰ˆæœ¬ç®¡ç†å·¥å…·-pyenv" class="headerlink" title="ç‰ˆæœ¬ç®¡ç†å·¥å…· - pyenv"></a>ç‰ˆæœ¬ç®¡ç†å·¥å…· - pyenv</h2><h1 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h1><h2 id="åŒ…ç®¡ç†å·¥å…·-npm"><a href="#åŒ…ç®¡ç†å·¥å…·-npm" class="headerlink" title="åŒ…ç®¡ç†å·¥å…· - npm"></a>åŒ…ç®¡ç†å·¥å…· - npm</h2><h1 id="åŒ…ç®¡ç†å·¥å…·-brew"><a href="#åŒ…ç®¡ç†å·¥å…·-brew" class="headerlink" title="åŒ…ç®¡ç†å·¥å…· - brew"></a>åŒ…ç®¡ç†å·¥å…· - brew</h1><ul>
<li><code>brew update</code> æ›´æ–° brew package</li>
</ul>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2018/04/09/å¸¸ç”¨å·¥å…·/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2018/04/09/å¸¸ç”¨å·¥å…·/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-å¦‚ä½•ç”¨-Objective-C-å®ç°ä¸€ä¸ªæ­»é”" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2018/04/02/å¦‚ä½•ç”¨-Objective-C-å®ç°ä¸€ä¸ªæ­»é”/">å¦‚ä½•ç”¨ Objective-C å®ç°ä¸€ä¸ªæ­»é”</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2018/04/02/å¦‚ä½•ç”¨-Objective-C-å®ç°ä¸€ä¸ªæ­»é”/">
            <time datetime="2018-04-01T20:29:42.000Z" itemprop="datePublished">2018-04-01</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/GCD/">GCD</a>, <a class="tag-link" href="/blog/tags/Objective-C/">Objective-C</a>, <a class="tag-link" href="/blog/tags/iOS/">iOS</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>å½“ç³»ç»Ÿå­˜åœ¨ä¸¤ä¸ªçº¿ç¨‹åŠä»¥ä¸Šçš„æ—¶å€™ï¼ŒåŒæ–¹éƒ½åœ¨ç­‰å¾…å¯¹æ–¹åœæ­¢æ‰§è¡Œï¼Œä»¥è·å¾—ç³»ç»Ÿèµ„æºï¼Œä½†æ˜¯æ²¡æœ‰ä¸€æ–¹æå‰é€€å‡ºçš„æ—¶å€™å°±å«åšæ­»é”ã€‚</p>
</blockquote>
<p>é‚£åœ¨ Objective-C é‡Œé¢å¦‚ä½•å®ç°æ­»é”å‘¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">self.lock1 = [NSLock new];</span><br><span class="line">self.lock2 = [NSLock new];</span><br><span class="line">    </span><br><span class="line">dispatch_async(dispatch_queue_create(&quot;com.papa.task1&quot;, DISPATCH_QUEUE_SERIAL), ^&#123;</span><br><span class="line">    [self.lock1 lock];</span><br><span class="line">    NSLog(@&quot;task1 è·å¾— lock1&quot;);</span><br><span class="line">    sleep(2);</span><br><span class="line">    [self.lock2 lock];</span><br><span class="line">    NSLog(@&quot;task1 è·å¾— lock2&quot;);</span><br><span class="line">    [self.lock2 unlock];</span><br><span class="line">    [self.lock1 unlock];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">dispatch_async(dispatch_queue_create(&quot;com.papa.task2&quot;, DISPATCH_QUEUE_SERIAL), ^&#123;</span><br><span class="line">    [self.lock2 lock];</span><br><span class="line">    NSLog(@&quot;task2 è·å¾— lock2&quot;);</span><br><span class="line">    sleep(2);</span><br><span class="line">    [self.lock1 lock];</span><br><span class="line">    NSLog(@&quot;task2 è·å¾— lock1&quot;);</span><br><span class="line">    [self.lock1 unlock];</span><br><span class="line">    [self.lock2 unlock];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€åæ§åˆ¶å°è¾“å‡ºçš„ç»“æœæ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">task2 è·å¾— lock2</span><br><span class="line">task1 è·å¾— lock1</span><br></pre></td></tr></table></figure>
<p>æˆ–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">task2 è·å¾— lock2</span><br><span class="line">task1 è·å¾— lock1</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆæ˜¯ä¸¤ç§ç»“æœå‘¢ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„<a href="https://hparis.github.io/blog/2017/09/05/%E5%88%9D%E6%AD%A5%E4%BA%86%E8%A7%A3GCD/">ã€Œåˆæ­¥äº†è§£ GCDã€</a>ã€‚</p>
<p>ä½†æ˜¯ä¸ç®¡å¦‚ä½•ï¼Œè¿™ä¸¤ç§ç»“æœéƒ½æ²¡æœ‰è¾“å‡º <code>task1 è·å¾— lock2</code> æˆ– <code>task2 è·å¾— lock1</code>ã€‚æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š</p>
<ul>
<li>task1 è·å¾— lock1ï¼Œç„¶åæ²‰ç¡ 2s</li>
<li>task2 è·å¾— lock2ï¼Œç„¶åæ²‰ç¡ 2s</li>
<li>task1 ç»è¿‡ 2s çš„æ²‰ç¡ä¹‹åæƒ³è¦å»è·å– lock2ï¼Œæ­¤æ—¶å‘ç° lock2 å·²ç»è¢«ä½¿ç”¨ï¼Œé‚£å°±ç»§ç»­ç­‰å¾…</li>
<li>task2 ç»è¿‡ 2s çš„æ²‰ç¡ä¹‹åæƒ³è¦å»è·å– lock1ï¼Œæ­¤æ—¶å‘ç° lock1 å·²ç»è¢«ä½¿ç”¨ï¼Œé‚£å°±ç»§ç»­ç­‰å¾…</li>
<li>task1 åˆè¢«å”¤é†’æƒ³è¦å»è·å– lock2ï¼Œæ­¤æ—¶ lock2 ä¾æ—§æ²¡æœ‰è¢« task2 é‡Šæ”¾ï¼Œåªèƒ½ç»§ç»­ç­‰å¾…</li>
<li>task2 åˆè¢«å”¤é†’æƒ³è¦å»è·å– lock1ï¼Œæ­¤æ—¶ lock1 ä¾æ—§æ²¡æœ‰è¢« task1 é‡Šæ”¾ï¼Œåªèƒ½ç»§ç»­ç­‰å¾…</li>
<li>â€¦</li>
<li>â€¦</li>
</ul>
<p>äºæ˜¯ task1 å’Œ task2 éƒ½åœ¨ç­‰å¾…å¯¹æ–¹é‡Šæ”¾èµ„æºï¼Œä½†æ˜¯è‡ªå·±ä¹Ÿä¸é€€å‡ºä¹Ÿä¸é‡Šæ”¾èµ„æºï¼Œæœ€ç»ˆå¯¼è‡´æ­»é”çš„äº§ç”Ÿã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥è®¨è®ºå¦å¤–ä¸€ä¸ªä¾‹å­æ˜¯ä¸æ˜¯æ­»é”ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// æŸä¸ªæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶</span><br><span class="line">- (void)onClick:(UIEvent *)event &#123;</span><br><span class="line">    dispatch_sync(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        ...    </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸ä¿¡å¤§å®¶éƒ½çŸ¥é“ä¸Šé¢è¿™ä¸ªä¾‹å­ä¼šå¯¼è‡´ä¸»çº¿ç¨‹å‘ç”Ÿé˜»å¡çš„ç°è±¡ï¼Œä½†æ˜¯è¿™æ˜¯å› ä¸ºæ­»é”é€ æˆçš„ä¹ˆï¼Ÿ</p>
<blockquote>
<p>Submits a block to a dispatch queue for synchronous execution. Unlike dispatch_async, this function does not return until the block has finished. Calling this function and targeting the current queue results in deadlock.</p>
</blockquote>
<p>åœ¨å®˜æ–¹æ–‡æ¡£é‡Œé¢æ˜ç¡®çš„è¯´äº†ï¼Œè¿™å°±æ˜¯æ­»é”ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„ä¾‹å­â€œç¿»è¯‘â€ä¸€ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// é¦–å…ˆè¿›å…¥ onClick çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ­¤æ—¶æ˜¯éœ€è¦åŠ é”çš„</span><br><span class="line">// æŸä¸ªæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶</span><br><span class="line">- (void)onClick:(UIEvent *)event &#123;</span><br><span class="line">    [self.lock1 lock];</span><br><span class="line">    </span><br><span class="line">    // æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è®¤ä¸º dispatch_sync æ˜¯åœ¨è·å– block é‡Œé¢çš„ lock2 </span><br><span class="line">    &#123;</span><br><span class="line">        [self.lock2 lock];</span><br><span class="line">        </span><br><span class="line">        // æ”¾åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œé‚£ä¹ˆå®ƒä¹Ÿéœ€è¦è·å¾— lock1 </span><br><span class="line">        [self.lock1 lock];</span><br><span class="line">        [self.lock1 unlock];</span><br><span class="line">        </span><br><span class="line">        [self.lock2 unlock];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [self.lock1 unlock];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶å®ä¸Šé¢çš„æƒ…å†µå°±æ˜¯ä¸¤ä¸ªä»»åŠ¡éƒ½åœ¨åŒæ—¶ç«äº‰ä¸»çº¿ç¨‹çš„èµ„æºï¼Œå¹¶ä¸”è°éƒ½æ²¡æœ‰é€€å‡ºæœ€ç»ˆå¯¼è‡´æ­»é”çš„äº§ç”Ÿã€‚ä½†æ˜¯è¿™ä¸¤ä¸ªä»»åŠ¡å¹¶ä¸æ˜¯æ™®é€šçš„ä¸¤ä¸ªçº¿ç¨‹åœ¨ç«äº‰èµ„æºï¼Œè€Œæ˜¯éƒ½åœ¨ä¸»çº¿ç¨‹ä¸Šï¼Œä¸€ä¸ªåµŒå¥—å¦å¤–ä¸€ä¸ªã€‚è€Œä¸”è¿™ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œåœ¨è¿è¡Œçš„æ—¶å€™ä¼šç›´æ¥å¯¼è‡´å¥”æºƒï¼Œè€Œä¸åƒæˆ‘ä»¬ä¸€å¼€å§‹çš„ä¾‹å­ä¸€æ ·åªæ˜¯åœ¨äº’ç›¸ç­‰å¾…ã€‚ä½†æ˜¯æ—¢ç„¶è‹¹æœæŠŠè¿™ç§æƒ…å†µä¹Ÿç§°ä¸ºæ­»é”ï¼Œé‚£æˆ‘ä»¬å°±å½“åšæ­»é”æ¥çœ‹å¾…ï¼Œæ¯•ç«Ÿä»–ä»¬éƒ½æ˜¯åœ¨ç«äº‰ç³»ç»Ÿèµ„æºã€‚</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2018/04/02/å¦‚ä½•ç”¨-Objective-C-å®ç°ä¸€ä¸ªæ­»é”/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2018/04/02/å¦‚ä½•ç”¨-Objective-C-å®ç°ä¸€ä¸ªæ­»é”/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-è¯´è¯´-Objective-C-ä¸­çš„-Copy-æ“ä½œ" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2018/03/24/è¯´è¯´-Objective-C-ä¸­çš„-Copy-æ“ä½œ/">è¯´è¯´ Objective-C ä¸­çš„ Copy æ“ä½œ</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2018/03/24/è¯´è¯´-Objective-C-ä¸­çš„-Copy-æ“ä½œ/">
            <time datetime="2018-03-23T16:35:55.000Z" itemprop="datePublished">2018-03-23</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/Objective-C/">Objective-C</a>, <a class="tag-link" href="/blog/tags/iOS/">iOS</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="æµ…æ‹·è´ï¼ˆShallow-copiesï¼‰å’Œæ·±æ‹·è´ï¼ˆDeep-copiesï¼‰"><a href="#æµ…æ‹·è´ï¼ˆShallow-copiesï¼‰å’Œæ·±æ‹·è´ï¼ˆDeep-copiesï¼‰" class="headerlink" title="æµ…æ‹·è´ï¼ˆShallow copiesï¼‰å’Œæ·±æ‹·è´ï¼ˆDeep copiesï¼‰"></a>æµ…æ‹·è´ï¼ˆShallow copiesï¼‰å’Œæ·±æ‹·è´ï¼ˆDeep copiesï¼‰</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ Objective-C ä¸­æŠŠ Copy æ“ä½œåˆ†æˆä¸¤ç§ï¼š<code>æµ…æ‹·è´ï¼ˆShallow copiesï¼‰</code>å’Œ<code>æ·±æ‹·è´ï¼ˆDeep copiesï¼‰</code>ã€‚å­¦è¿‡ C è¯­è¨€çš„åŒå­¦åº”è¯¥çŸ¥é“åŒºåˆ†è¿™ä¸¤ç§æ“ä½œçš„åŒºåˆ«å…¶å®å¾ˆç®€å•ï¼š</p>
<blockquote>
<p>æµ…æ‹·è´ï¼ˆShallow copiesï¼‰: æŒ‡é’ˆæ‹·è´ï¼ŒæŒ‡å‘çš„è¿˜æ˜¯åŒä¸€å—å†…å®¹çš„åœ°å€<br>æ·±æ‹·è´ï¼ˆDeep copiesï¼‰: å†…å®¹æ‹·è´</p>
</blockquote>
<p>ä½†æ˜¯åœ¨ Objective-C é‡Œé¢å¯¹äº Copy çš„å®ç°è¿˜æ˜¯è·Ÿ C è¯­è¨€çš„æœ‰ç‚¹å·®åˆ«ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ Apple çš„å®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„ä¸€å¼ å›¾ï¼š</p>
<p><img src="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Collections/Art/CopyingCollections_2x.png" alt="Collections Programming Topics"></p>
<p>é€šè¿‡ä¸Šå›¾å¯ä»¥çœ‹å‡º<code>æµ…æ‹·è´</code>è¿‡åï¼ŒArray 1 å’Œ Array 2 çš„å…ƒç´ éƒ½æ˜¯ç›¸åŒçš„æŒ‡é’ˆåœ°å€ï¼ŒæŒ‡å‘ç›¸åŒçš„å†…å®¹ï¼›<code>æ·±æ‹·è´</code>è¿‡åï¼Œå†…å®¹è¢«æ‹·è´ä¸€ä»½æ–°çš„å‡ºæ¥ï¼ŒArray 2 çš„å…ƒç´ çš„æŒ‡é’ˆåœ°å€éƒ½å’Œ Array 1 ä¸ä¸€æ ·ï¼Œå› ä¸º Array2 çš„å…ƒç´ çš„æŒ‡é’ˆåœ°å€éƒ½æŒ‡å‘æ–°çš„å†…å®¹ã€‚</p>
<h2 id="immutable-å’Œ-mutable-å¯¹è±¡çš„æ‹·è´"><a href="#immutable-å’Œ-mutable-å¯¹è±¡çš„æ‹·è´" class="headerlink" title="immutable å’Œ mutable å¯¹è±¡çš„æ‹·è´"></a>immutable å’Œ mutable å¯¹è±¡çš„æ‹·è´</h2><p>åœ¨ Objective-C ä¸­ä¸€èˆ¬ä¼šç”¨ copy æˆ– mutableCopy è¿›è¡Œæ‹·è´æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯ŸæŒ‡é’ˆå˜åŒ–æ¥ç¡®å®šè¿™ä¸¤ç§æ‹·è´æ“ä½œæ˜¯<code>æµ…å¤åˆ¶</code>è¿˜æ˜¯<code>æ·±å¤åˆ¶</code>ã€‚</p>
<ul>
<li><p>immutable å¯¹è±¡çš„å¤åˆ¶æ“ä½œ</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NSString * aName = @&quot;å¸•å¸•&quot;;</span><br><span class="line">NSString * bName = [aName copy];</span><br><span class="line">NSMutableString * cName = [aName mutableCopy];</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;aName çš„æŒ‡é’ˆï¼š%p&quot;, aName);</span><br><span class="line">NSLog(@&quot;bName çš„æŒ‡é’ˆï¼š%p&quot;, bName);</span><br><span class="line">NSLog(@&quot;cName çš„æŒ‡é’ˆï¼š%p&quot;, cName);</span><br></pre></td></tr></table></figure>
<p>  è¾“å‡ºçš„ç»“æœï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aName çš„æŒ‡é’ˆï¼š0x103d34070</span><br><span class="line">bName çš„æŒ‡é’ˆï¼š0x103d34070</span><br><span class="line">cName çš„æŒ‡é’ˆï¼š0x600000250dd0</span><br></pre></td></tr></table></figure>
</li>
<li><p>mutable å¯¹è±¡çš„å¤åˆ¶æ“ä½œ</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NSMutableString * aName = [NSMutableString stringWithString:@&quot;å¸•å¸•&quot;];</span><br><span class="line">NSString * bName = [aName copy];</span><br><span class="line">NSMutableString * cName = [aName mutableCopy];</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;aName çš„æŒ‡é’ˆï¼š%p&quot;, aName);</span><br><span class="line">NSLog(@&quot;bName çš„æŒ‡é’ˆï¼š%p&quot;, bName);</span><br><span class="line">NSLog(@&quot;cName çš„æŒ‡é’ˆï¼š%p&quot;, cName);</span><br></pre></td></tr></table></figure>
<p>  è¾“å‡ºçš„ç»“æœï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aName çš„æŒ‡é’ˆï¼š0x60000025e150</span><br><span class="line">bName çš„æŒ‡é’ˆï¼š0x600000222900</span><br><span class="line">cName çš„æŒ‡é’ˆï¼š0x60000025e450</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>é€šè¿‡ä¸Šé¢ä¸¤ä¸ªä¾‹å­ä»¥åŠå®ƒä»¬çš„è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸‹é¢è¿™ä¸ªè¡¨æ ¼ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">imutable å¯¹è±¡</th>
<th style="text-align:center">mutable å¯¹è±¡</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">copy</td>
<td style="text-align:center">æµ…å¤åˆ¶</td>
<td style="text-align:center">æ·±å¤åˆ¶</td>
</tr>
<tr>
<td style="text-align:center">mutableCopy</td>
<td style="text-align:center">æ·±å¤åˆ¶</td>
<td style="text-align:center">æ·±å¤åˆ¶</td>
</tr>
</tbody>
</table>
<p>ä¸Šé¢çš„è§„åˆ™å¯¹é›†åˆå¯¹è±¡ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼šNSArray å’Œ NSMutableArrayï¼ŒNSDictionary å’Œ NSMutableDictionaryï¼ŒNSSet å’Œ NSMutableSet</p>
<h2 id="å•å±‚æ·±å¤åˆ¶ï¼ˆone-level-deepï¼‰"><a href="#å•å±‚æ·±å¤åˆ¶ï¼ˆone-level-deepï¼‰" class="headerlink" title="å•å±‚æ·±å¤åˆ¶ï¼ˆone-level-deepï¼‰"></a>å•å±‚æ·±å¤åˆ¶ï¼ˆone-level-deepï¼‰</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">NSMutableString * aString = [NSMutableString stringWithString:@&quot;Hello&quot;]</span><br><span class="line"></span><br><span class="line">NSMutableArray * aArray = [NSMutableArray arrayWithObjects:aString, nil];</span><br><span class="line">NSArray * bArray = [aArray copy];</span><br><span class="line"></span><br><span class="line">NSMutableString * bString = bArray[0];</span><br><span class="line">[bString appendString:@&quot; å¸•å¸•&quot;];</span><br><span class="line">    </span><br><span class="line">NSLog(@&quot;aArray çš„æŒ‡é’ˆï¼š%p&quot;, aName);</span><br><span class="line">NSLog(@&quot;bArray çš„æŒ‡é’ˆï¼š%p&quot;, bName);</span><br><span class="line">NSLog(@&quot;aArray ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ: %pï¼Œå†…å®¹ï¼š%@&quot;, aArray[0], aArray[0]);</span><br><span class="line">NSLog(@&quot;bArray ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ: %pï¼Œå†…å®¹ï¼š%@&quot;, bArray[0], bArray[0]);</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aArray çš„æŒ‡é’ˆï¼š0x60000025d9a0</span><br><span class="line">bArray çš„æŒ‡é’ˆï¼š0x60000002cf60</span><br><span class="line">aArray ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ: 0x60000025d880ï¼Œå†…å®¹ï¼šHello å¸•å¸•</span><br><span class="line">bArray ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ: 0x60000025d880ï¼Œå†…å®¹ï¼šHello å¸•å¸•</span><br></pre></td></tr></table></figure>
<p>ä» aArray åˆ° bArray çš„ copy æ“ä½œä¹‹åï¼Œå®ƒä»¬çš„æŒ‡é’ˆåœ°å€å‘ç”Ÿäº†å˜åŒ–ï¼ŒæŒ‰ç…§æˆ‘ä»¬ä¹‹å‰çš„ç†è§£è¿™æ˜¯<code>æ·±æ‹·è´</code>ã€‚<code>æ·±æ‹·è´</code>ä¼šæŠŠ aArray çš„å…ƒç´ éƒ½æ‹·è´ä¸€ä»½ï¼Œé‚£ä¸ºä»€ä¹ˆæ”¹å˜ bArray çš„å…ƒç´ çš„å€¼ä¼šå¯¼è‡´ aArray çš„å…ƒç´ çš„å€¼ä¹Ÿå‘ç”Ÿäº†å˜åŒ–å‘¢ï¼Ÿ</p>
<p><img src="https://i.imgur.com/svn3AbQ.png" alt="é›†åˆå¯¹è±¡çš„æ·±æ‹·è´"></p>
<h2 id="å®Œå…¨æ·±å¤åˆ¶"><a href="#å®Œå…¨æ·±å¤åˆ¶" class="headerlink" title="å®Œå…¨æ·±å¤åˆ¶"></a>å®Œå…¨æ·±å¤åˆ¶</h2><p>é‚£æˆ‘ä»¬è¦å¦‚ä½•åšåˆ°çœŸæ­£çš„æ·±å¤åˆ¶å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç®€å•çš„æŠŠä¸Šé¢çš„ä»£ç æ”¹ä¸€ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">NSMutableString * aString = [NSMutableString stringWithString:@&quot;Hello&quot;]</span><br><span class="line"></span><br><span class="line">NSMutableArray * aArray = [NSMutableArray arrayWithObjects:aString, nil];</span><br><span class="line"></span><br><span class="line">// åªéœ€è¦æ”¹åŠ¨è¿™ä¸€è¡Œä»£ç </span><br><span class="line">NSArray *bArray = [NSKeyedUnarchiver unarchiveObjectWithData:[NSKeyedArchiver archivedDataWithRootObject:aArray]];</span><br><span class="line"></span><br><span class="line">NSMutableString * bString = bArray[0];</span><br><span class="line">[bString appendString:@&quot; å¸•å¸•&quot;];</span><br><span class="line">    </span><br><span class="line">NSLog(@&quot;aArray çš„æŒ‡é’ˆï¼š%p&quot;, aName);</span><br><span class="line">NSLog(@&quot;bArray çš„æŒ‡é’ˆï¼š%p&quot;, bName);</span><br><span class="line">NSLog(@&quot;aArray ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ: %pï¼Œå†…å®¹ï¼š%@&quot;, aArray[0], aArray[0]);</span><br><span class="line">NSLog(@&quot;bArray ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ: %pï¼Œå†…å®¹ï¼š%@&quot;, bArray[0], bArray[0]);</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aArray çš„æŒ‡é’ˆï¼š0x600000259cb0</span><br><span class="line">bArray çš„æŒ‡é’ˆï¼š0x600000030ac0</span><br><span class="line">aArray ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ: 0x604000452120ï¼Œå†…å®¹ï¼šHello</span><br><span class="line">bArray ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ: 0x604000452780ï¼Œå†…å®¹ï¼šHello å¸•å¸•</span><br></pre></td></tr></table></figure>
<p>åªè¦å…ˆå¯¹é›†åˆå¯¹è±¡åˆ†åˆ«ç”¨ NSKeyedArchiver å’Œ NSKeyedUnarchiver å°±å¯ä»¥çœŸæ­£å®Œæˆå¯¹ä¸€ä¸ªé›†åˆå¯¹è±¡çš„æ·±å¤åˆ¶ã€‚</p>
<h2 id="Copy-å’Œ-å†…å­˜ç®¡ç†"><a href="#Copy-å’Œ-å†…å­˜ç®¡ç†" class="headerlink" title="Copy å’Œ å†…å­˜ç®¡ç†"></a>Copy å’Œ å†…å­˜ç®¡ç†</h2><p>ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ Objective-C é‡Œé¢å¯¹äº Copy çš„å®ç°è¿˜æ˜¯è·Ÿ C è¯­è¨€çš„æœ‰ç‚¹å·®åˆ«ï¼Œé‚£å·®åˆ«åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ<br>å†…å­˜ä¸­åšå¤åˆ¶æ“ä½œæ˜¯å¾ˆè€—è´¹èµ„æºçš„ï¼Œè€Œæˆ‘ä»¬éƒ½çŸ¥é“ Objective-C é«˜æ•ˆçš„ä¸€ä¸ªåŸå› åœ¨äºå®ƒçš„å†…å­˜ç®¡ç†æœºåˆ¶æ˜¯<code>å¼•ç”¨è®¡æ•°</code>ã€‚æˆ‘ä»¬å‰é¢åˆ†æçš„<code>æ·±æ‹·è´</code>æ˜¯å¯¹å†…å®¹çš„æ‹·è´ï¼Œè¿™ä¸€ç‚¹è·Ÿ C è¯­è¨€çš„ä¸€æ ·ã€‚C è¯­è¨€çš„<code>æµ…æ‹·è´</code>æ˜¯æŒ‡é’ˆçš„æ‹·è´ï¼Œå®ƒä¾æ—§åšäº†ä¸€æ¬¡å¤åˆ¶æ“ä½œã€‚è€Œåœ¨ Objective-C ä¸­ï¼Œ<code>æµ…æ‹·è´</code>å…¶å®åªæ˜¯å¼•ç”¨è®¡æ•°çš„å¢åŠ ï¼Œä¸ä¿¡çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NSArray * aArray = [NSArray arrayWithObjects:@&quot;å¸•å¸•&quot;, nil];</span><br><span class="line">NSLog(@&quot;aArray çš„æŒ‡é’ˆï¼š%pï¼Œå¼•ç”¨è®¡æ•°ï¼š%ld&quot;, aArray, CFGetRetainCount((__bridge CFTypeRef)(aArray)));</span><br><span class="line">NSArray * bArray = [aArray copy];</span><br><span class="line">NSLog(@&quot;aArray çš„æŒ‡é’ˆï¼š%pï¼Œå¼•ç”¨è®¡æ•°ï¼š%ld&quot;, aArray, CFGetRetainCount((__bridge CFTypeRef)(aArray)));</span><br><span class="line">NSMutableArray * cArray = [aArray mutableCopy];</span><br><span class="line">NSLog(@&quot;aArray çš„æŒ‡é’ˆï¼š%pï¼Œå¼•ç”¨è®¡æ•°ï¼š%ld&quot;, aArray, CFGetRetainCount((__bridge CFTypeRef)(aArray)));</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aArray çš„æŒ‡é’ˆï¼š0x604000443ba0ï¼Œå¼•ç”¨è®¡æ•°ï¼š2</span><br><span class="line">aArray çš„æŒ‡é’ˆï¼š0x604000443ba0ï¼Œå¼•ç”¨è®¡æ•°ï¼š3</span><br><span class="line">aArray çš„æŒ‡é’ˆï¼š0x604000443ba0ï¼Œå¼•ç”¨è®¡æ•°ï¼š3</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆ aArray åˆšå‡ºæ¥çš„æ—¶å€™çš„å¼•ç”¨è®¡æ•°æ˜¯ 2ï¼Ÿå› ä¸º <code>[NSArray arrayWithObjects:@&quot;å¸•å¸•&quot;, nil]</code> æœ¬èº«å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„å¼•ç”¨è®¡æ•°å°±æ˜¯ 1ï¼›ç„¶åæˆ‘ä»¬åˆå®šä¹‰äº† aArray æ¥å¼•ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶å®ƒçš„å¼•ç”¨è®¡æ•°å°±å¢åŠ äº† 1ï¼Œå˜æˆäº† 2ï¼›ä¹‹åæˆ‘ä»¬å¯¹ aArray è¿›è¡Œäº† copy æ“ä½œï¼Œå‘ç°å®ƒçš„å¼•ç”¨è®¡æ•°å˜æˆäº† 3ï¼Œæ‰€ä»¥è¿™é‡Œçš„ copy æ“ä½œå…¶å®ç›¸å½“äº retaionï¼›æœ€æœ‰æˆ‘ä»¬å¯¹ aArray è¿›è¡Œäº† mutableCopy æ“ä½œï¼Œæ­¤æ—¶å®ƒçš„å¼•ç”¨è®¡æ•°è¿˜æ˜¯ 3ï¼Œæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™è¿›è¡Œäº†å†…å®¹å¤åˆ¶ã€‚</p>
<p>æ‰€ä»¥åœ¨ Objective-C ä¸­å¯¹ä¸€ä¸ª imutable å¯¹è±¡è¿›è¡Œçš„ copyï¼ˆæµ…å¤åˆ¶ï¼‰æ“ä½œï¼Œå…¶å®éƒ½åªä¼šå¼•èµ·å¼•ç”¨è®¡æ•°çš„å˜åŒ–ï¼Œè€Œä¸ä¼šåœ¨å†…å­˜ä¸­åšå‡ºä»»ä½•æ‹·è´æ“ä½œï¼ŒåŒ…æ‹¬æŒ‡é’ˆæ‹·è´ã€‚</p>
<h2 id="NSCopying-å’Œ-NSMutableCopying"><a href="#NSCopying-å’Œ-NSMutableCopying" class="headerlink" title="NSCopying å’Œ NSMutableCopying"></a>NSCopying å’Œ NSMutableCopying</h2><p>å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„å¯¹è±¡ï¼Œå¹¶ä¸”å¯¹å…¶è¿›è¡Œ copy æ“ä½œçš„è¯ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// Person</span><br><span class="line">@interface Person: NSObject</span><br><span class="line">@property (nonatomic, copy) NSString * name;</span><br><span class="line">@end</span><br><span class="line">@implementation Person</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">Person * aPerson = [Person new];</span><br><span class="line">Person * bPerson = [aPerson copy];</span><br></pre></td></tr></table></figure>
<p>Xcode ç›´æ¥å¥”æºƒäº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// å´©æºƒ</span><br><span class="line">*** Terminating app due to uncaught exception &apos;NSInvalidArgumentException&apos;, reason: &apos;-[Person copyWithZone:]: unrecognized selector sent to instance 0x60000000d5f0&apos;</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯¹ä¸€ä¸ª Person å¯¹è±¡ä½¿ç”¨äº† copyï¼ŒXcode ç¡®æŠ¥çš„æ˜¯æ‰¾ä¸åˆ° <code>copyWithZone:</code> è¿™ä¸ª selector çš„é”™è¯¯ã€‚</p>
<p>è¿™æ˜¯å› ä¸º Objective-C ä¸­è§„å®šï¼Œä¸€ä¸ªå¯¹è±¡å¦‚æœæƒ³è¦ä½¿ç”¨ copy æˆ– mutableCopy çš„æ“ä½œï¼Œå¿…é¡»è¦å®ç° <code>NSCopying</code> æˆ– <code>NSMutableCopying</code> è¿™ä¸¤ä¸ªåè®®ã€‚è¿™ä¸¤ä¸ªåè®®è§„å®šäº†å¯¹è±¡éœ€è¦å®ç° <code>copyWithZone:</code> æˆ– <code>mutableCopyWithZone:</code> è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå› ä¸ºå¯¹ä¸€ä¸ªå¯¹è±¡åš copy æˆ– mutableCopy æœ€åéƒ½ä¼šå»è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•æ¥åšæœ€ç»ˆçš„å®ç°ã€‚<br>ä¸Šé¢ä¾‹å­ä¸­çš„é›†åˆå¯¹è±¡èƒ½å¤Ÿä½¿ç”¨ copy å’Œ mutableCopy æ“ä½œæ˜¯ä¹Ÿå› ä¸ºå®ƒä»¬éƒ½å®ç°äº† NSCopying å’Œ NSMutableCopying åè®®ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å¯¹ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡å®ç° NSCopying åè®®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@interface Person: NSObject &lt;NSCopying&gt;</span><br><span class="line">@property (nonatomic, copy) NSString * name;</span><br><span class="line">@property (nonatomic, strong) NSMutableArray * mArray;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation Person</span><br><span class="line">- (instancetype)copyWithZone:(NSZone *)zone &#123;</span><br><span class="line">    Person * person = [[self class] new];</span><br><span class="line">    person.name = [self.name copy];</span><br><span class="line">    person.mArray = [self.mArray mutableCopy];</span><br><span class="line">    return person;</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨ <code>[Person copy]</code> äº†ã€‚å½“ç„¶ï¼Œè¿™é‡Œ Person çš„ mArray ä¹Ÿåªæ˜¯<code>å•å±‚æ·±å¤åˆ¶</code>ï¼Œå¦‚æœæƒ³è¦å®ç°<code>å®Œå…¨æ·±å¤åˆ¶</code>çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ NSKeyedArchiver å’Œ NSKeyedUnarchiver æ¥å®Œæˆå¯¹ mArray çš„<code>å®Œå…¨æ·±å¤åˆ¶</code>ã€‚</p>
<h2 id="Block-å’Œ-Copy"><a href="#Block-å’Œ-Copy" class="headerlink" title="Block å’Œ Copy"></a>Block å’Œ Copy</h2><p>ç®€å•è¯´ä¸€ä¸‹ï¼Œåœ¨ Objective-C ä¸­ï¼ŒBlock çš„ copy æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ“ä½œã€‚å› ä¸º Block æ˜¯ä¸€ç§ç»“æ„ä½“ï¼Œå®ƒæ— æ³•å®ç° NSCopying æˆ– NSMutableCopying åè®®ï¼Œä½†æ˜¯å®ƒå´å¯ä»¥è°ƒç”¨ copy æ–¹æ³•ã€‚è¿™æ˜¯ç”± Block çš„ç»“æ„ä½“å†³å®šçš„ï¼š</p>
<p><img src="http://www.devtalking.com/postImages/block-struct.jpg" alt=""></p>
<p>Block é‡Œé¢çš„ descriptor æœ‰ copy çš„å‡½æ•°æŒ‡é’ˆï¼Œå½“å¯¹ Block æ‰§è¡Œ copy æ“ä½œæœ€åéƒ½ä¼šé€šè¿‡è¯¥å‡½æ•°æŒ‡é’ˆè¿›è¡ŒçœŸæ­£çš„æ“ä½œã€‚è¿™ä¹Ÿæ˜¯ Blocçœ‹ä¸éœ€è¦å®ç° NSCopying å’Œ NSMutableCopying å°±èƒ½è°ƒç”¨ copy æ–¹æ³•çš„åŸå› ã€‚</p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<ol>
<li><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Collections/Articles/Copying.html" target="_blank" rel="noopener">https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/Collections/Articles/Copying.html</a></li>
<li><a href="https://www.zybuluo.com/MicroCai/note/50592" target="_blank" rel="noopener">https://www.zybuluo.com/MicroCai/note/50592</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2018/03/24/è¯´è¯´-Objective-C-ä¸­çš„-Copy-æ“ä½œ/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2018/03/24/è¯´è¯´-Objective-C-ä¸­çš„-Copy-æ“ä½œ/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-å¦‚ä½•åœ¨-iOS-ä¸Šè‡ªå®šä¹‰-React-Native-Component" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2018/03/20/å¦‚ä½•åœ¨-iOS-ä¸Šè‡ªå®šä¹‰-React-Native-Component/">å¦‚ä½•åœ¨ iOS ä¸Šè‡ªå®šä¹‰ React Native Component</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2018/03/20/å¦‚ä½•åœ¨-iOS-ä¸Šè‡ªå®šä¹‰-React-Native-Component/">
            <time datetime="2018-03-19T17:22:09.000Z" itemprop="datePublished">2018-03-19</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/RN/">RN</a>, <a class="tag-link" href="/blog/tags/iOS/">iOS</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>å½“æˆ‘ä»¬è¦åœ¨ iOS ç«¯å®ç°ä¸€ä¸ª React Native å¯ç”¨çš„ Componentï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;MapView onRegionChange=&#123;(event) =&gt; &#123;&#125;&#125; zoomLevel=&#123;2&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæˆ‘ä»¬åŸºæœ¬ä¸Šå°±æ˜¯è¦è§£å†³ä¸‹é¢è¿™ä¸‰ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å¦‚ä½•æŠŠ iOS ä¸Šçš„ UI æš´éœ²ç»™ React Native ç«¯ï¼Ÿ</li>
<li>å¦‚ä½•åœ¨ React Native ç»™ iOS çš„ UI ä¼ å€¼ï¼Ÿ</li>
<li>å¦‚ä½•åœ¨ React Native ä¸­å“åº” iOS çš„äº‹ä»¶ï¼Ÿ</li>
</ul>
<blockquote>
<p>è¿™ä¸‰ä¸ªé—®é¢˜å¯ä»¥åœ¨<a href="https://facebook.github.io/react-native/docs/native-components-ios.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>æ‰¾åˆ°ç­”æ¡ˆã€‚</p>
</blockquote>
<h2 id="å¦‚ä½•æŠŠ-iOS-ä¸Šçš„-UI-æš´éœ²ç»™-React-Native-ç«¯"><a href="#å¦‚ä½•æŠŠ-iOS-ä¸Šçš„-UI-æš´éœ²ç»™-React-Native-ç«¯" class="headerlink" title="å¦‚ä½•æŠŠ iOS ä¸Šçš„ UI æš´éœ²ç»™ React Native ç«¯"></a>å¦‚ä½•æŠŠ iOS ä¸Šçš„ UI æš´éœ²ç»™ React Native ç«¯</h2><p>é¦–å…ˆä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª <code>RCTViewManager</code> çš„å­ç±»ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// RNTMapManager.m</span><br><span class="line">#import &lt;MapKit/MapKit.h&gt;</span><br><span class="line">#import &lt;React/RCTViewManager.h&gt;</span><br><span class="line"></span><br><span class="line">// ç»§æ‰¿ RCTViewManager</span><br><span class="line">@interface RNTMapManager : RCTViewManager</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation RNTMapManager</span><br><span class="line"></span><br><span class="line">// è°ƒç”¨ RCT_EXPORT_MODULE æš´éœ²è¯¥ç±»çš„åå­—ç»™ React Native ä½¿ç”¨ã€‚å¦‚æœä½ æƒ³è‡ªå®šä¹‰</span><br><span class="line">// æš´éœ²ç»™ React Native çš„åå­—æ—¶ï¼Œä½ éœ€è¦ RCT_EXPORT_MODULE(YOUR_CUSTOM_NAME)ã€‚</span><br><span class="line">RCT_EXPORT_MODULE()</span><br><span class="line"></span><br><span class="line">// ç”±äº RCTViewManager æ˜¯ NSObjectï¼Œæ‰€ä»¥è¿™é‡Œå¿…é¡»éœ€è¦å®ç°è¯¥æ–¹æ³•æ¥å‘Šè¯‰</span><br><span class="line">// React Native å»ä½¿ç”¨å“ªä¸ª UIView</span><br><span class="line">- (UIView *)view</span><br><span class="line">&#123;</span><br><span class="line">  return [MKMapView new];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ React Native ä½¿ç”¨ MapView äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// MapView.js</span><br><span class="line"></span><br><span class="line">import &#123; requireNativeComponent &#125; from &apos;react-native&apos;;</span><br><span class="line"></span><br><span class="line">// requireNativeComponent ä¼šè‡ªåŠ¨æŠŠ iOS ä¸Šçš„ RNTMapManager è§£ææˆ RNTMapã€‚</span><br><span class="line">// å¦‚æœå»æ‰ iOS ä¸Šçš„ Manager åç¼€ä¼šæœ‰ä»€ä¹ˆå½±å“ï¼Ÿå—¯ï¼Œæ²¡æœ‰ä»»ä½•å½±å“ã€‚</span><br><span class="line">module.exports = requireNativeComponent(&apos;RNTMap&apos;, null);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// MyApp.js</span><br><span class="line">import MapView from &apos;./MapView.js&apos;;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">  return &lt;MapView /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å¦‚ä½•åœ¨-React-Native-ç»™-iOS-çš„-UI-ä¼ å€¼"><a href="#å¦‚ä½•åœ¨-React-Native-ç»™-iOS-çš„-UI-ä¼ å€¼" class="headerlink" title="å¦‚ä½•åœ¨ React Native ç»™ iOS çš„ UI ä¼ å€¼"></a>å¦‚ä½•åœ¨ React Native ç»™ iOS çš„ UI ä¼ å€¼</h2><p>å¦‚æœéœ€è¦ä¼ å€¼ç»™ iOS ä¸Šçš„ UIï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨å¦å¤–ä¸€ä¸ªå®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RCT_EXPORT_VIEW_PROPERTY(zoomEnabled, BOOL)</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™å°±å¯ä»¥åœ¨ React Native ä¸Šä½¿ç”¨äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;MapView zoomEnable=&#123;true&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>RCT_EXPORT_VIEW_PROPERTY</code> æ‰€æš´éœ²çš„å±æ€§å¿…é¡»æ˜¯ä¹‹å‰æˆ‘ä»¬è¯´çš„ UIViewï¼ˆå³ç»§æ‰¿äº <code>RCTViewManager</code> å¹¶é€šè¿‡ <code>- (UIView *)view;</code> è¿”å›çš„ Viewï¼‰å·²ç»å­˜åœ¨çš„å±æ€§ã€‚</p>
<p>é™¤äº†ä¸Šé¢çš„å® <code>RCT_EXPORT_VIEW_PROPERTY</code> å¯ä»¥æš´éœ²å±æ€§ç»™ React Native ä½¿ç”¨ä¹‹å¤–è¿˜æœ‰ä¸‹é¢ 5 ç§ï¼ˆè¿™é‡Œå…ˆæŒ–ä¸ªå‘ï¼Œå›å¤´ç ”ç©¶ä¸€ä¸‹å†è¯´è¯´ä¸‹é¢äº”ç§çš„ä½œç”¨å’ŒåŒºåˆ«ï¼‰ï¼š</p>
<ul>
<li>RCT_REMAP_VIEW_PROPERTY</li>
<li>RCT_CUSTOM_VIEW_PROPERTY</li>
<li>RCT_EXPORT_SHADOW_PROPERTY</li>
<li>RCT_REMAP_SHADOW_PROPERTY</li>
<li>RCT_CUSTOM_SHADOW_PROPERTY</li>
</ul>
<h2 id="å¦‚ä½•åœ¨-React-Native-ä¸­å“åº”-iOS-çš„äº‹ä»¶"><a href="#å¦‚ä½•åœ¨-React-Native-ä¸­å“åº”-iOS-çš„äº‹ä»¶" class="headerlink" title="å¦‚ä½•åœ¨ React Native ä¸­å“åº” iOS çš„äº‹ä»¶"></a>å¦‚ä½•åœ¨ React Native ä¸­å“åº” iOS çš„äº‹ä»¶</h2><p>è¦æƒ³åœ¨ React Native ä¸­å“åº” iOS çš„äº‹ä»¶ï¼Œåªéœ€è¦æš´éœ²ç”¨ <code>RCTBubblingEventBlock</code> æˆ– <code>RCTDirectEventBlock</code> å®šä¹‰çš„å±æ€§å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// RNTMapView.h</span><br><span class="line">#import &lt;MapKit/MapKit.h&gt;</span><br><span class="line">#import &lt;React/RCTComponent.h&gt;</span><br><span class="line"></span><br><span class="line">// ç”±äº MKMapView æ²¡æœ‰ä»»ä½• `RCTBubblingEventBlock` æˆ– `RCTDirectEventBlock` æ‰€å®šä¹‰çš„</span><br><span class="line">// å±æ€§ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦å®šä¹‰ MKMapView çš„å­ç±» RNTMapView</span><br><span class="line">@interface RNTMapView: MKMapView</span><br><span class="line"></span><br><span class="line">// éœ€è¦æš´éœ²ç»™ React Native çš„äº‹ä»¶å±æ€§</span><br><span class="line">@property (nonatomic, copy) RCTBubblingEventBlock onRegionChange;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// RNTMapView.m</span><br><span class="line">#import &quot;RNTMapView.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation RNTMapView</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬éœ€è¦åœ¨ <code>RCTViewManager</code> ä¸­æš´éœ² <code>onRegionChange</code> ç»™ React Native ä½¿ç”¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// RNTMapManager.m</span><br><span class="line">#import &lt;MapKit/MapKit.h&gt;</span><br><span class="line">#import &lt;React/RCTViewManager.h&gt;</span><br><span class="line"></span><br><span class="line">#import &quot;RNTMapView.h&quot;</span><br><span class="line"></span><br><span class="line">@interface RNTMapManager : RCTViewManager &lt;MKMapViewDelegate&gt;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation RNTMapManager</span><br><span class="line"></span><br><span class="line">RCT_EXPORT_MODULE()</span><br><span class="line">// æš´éœ² RNTMapView ä¸­çš„ `onRegionChange` å±æ€§</span><br><span class="line">RCT_EXPORT_VIEW_PROPERTY(onRegionChange, RCTBubblingEventBlock)</span><br><span class="line"></span><br><span class="line">- (UIView *)view &#123;</span><br><span class="line">    // è¿™é‡Œéœ€è¦è¿”å› RNTMapView è€Œä¸æ˜¯ MKMapView</span><br><span class="line">    return [RNTMapView new];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<blockquote>
<p>é‡è¦çš„äº‹è¯´ä¸‰éï¼š<br>ä½¿ç”¨ <code>RCTBubblingEventBlock</code> æˆ– <code>RCTDirectEventBlock</code> æ‰€å®šä¹‰çš„äº‹ä»¶éƒ½å¿…é¡»åŠ ä¸Šå‰ç¼€ <code>on</code>ï¼Œå¦åˆ™ React Native æ— æ³•æ¥æ”¶åˆ°äº‹ä»¶<br>ä½¿ç”¨ <code>RCTBubblingEventBlock</code> æˆ– <code>RCTDirectEventBlock</code> æ‰€å®šä¹‰çš„äº‹ä»¶éƒ½å¿…é¡»åŠ ä¸Šå‰ç¼€ <code>on</code>ï¼Œå¦åˆ™ React Native æ— æ³•æ¥æ”¶åˆ°äº‹ä»¶<br>ä½¿ç”¨ <code>RCTBubblingEventBlock</code> æˆ– <code>RCTDirectEventBlock</code> æ‰€å®šä¹‰çš„äº‹ä»¶éƒ½å¿…é¡»åŠ ä¸Šå‰ç¼€ <code>on</code>ï¼Œå¦åˆ™ React Native æ— æ³•æ¥æ”¶åˆ°äº‹ä»¶</p>
</blockquote>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2018/03/20/å¦‚ä½•åœ¨-iOS-ä¸Šè‡ªå®šä¹‰-React-Native-Component/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2018/03/20/å¦‚ä½•åœ¨-iOS-ä¸Šè‡ªå®šä¹‰-React-Native-Component/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Raspberry-PI-åŸºæœ¬ä½¿ç”¨" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2018/03/06/Raspberry-PI-åŸºæœ¬ä½¿ç”¨/">Raspberry PI åŸºæœ¬ä½¿ç”¨</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2018/03/06/Raspberry-PI-åŸºæœ¬ä½¿ç”¨/">
            <time datetime="2018-03-05T22:04:56.000Z" itemprop="datePublished">2018-03-05</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/Raspberry-PI/">Raspberry PI</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/Raspberry-PI/">Raspberry PI</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="1-ä¿è¯-Raspberry-PI-èƒ½å¤Ÿåœ¨å¤–ç½‘ä½¿ç”¨"><a href="#1-ä¿è¯-Raspberry-PI-èƒ½å¤Ÿåœ¨å¤–ç½‘ä½¿ç”¨" class="headerlink" title="1. ä¿è¯ Raspberry PI èƒ½å¤Ÿåœ¨å¤–ç½‘ä½¿ç”¨"></a>1. ä¿è¯ Raspberry PI èƒ½å¤Ÿåœ¨å¤–ç½‘ä½¿ç”¨</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// åœ¨ä½ çš„ Raspberry PI ä¸Šä½¿ç”¨ autossh æ¥å®ç°ä¸æ‰çº¿çš„åå‘ä»£ç†ï¼š</span><br><span class="line">autossh -M 5678 -fNR 2018:localhost:22 root@54.219.12.213</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// åœ¨ä½ çš„å¤–ç½‘æœåŠ¡å™¨ï¼ˆæ¯”å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„ï¼š54.219.12.213ï¼‰ä¸Šå¯ä»¥ä½¿ç”¨ ssh ç™»å½•ä½ çš„ Raspberry PI</span><br><span class="line">ssh -p 2018 pi@127.0.0.1</span><br></pre></td></tr></table></figure>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2018/03/06/Raspberry-PI-åŸºæœ¬ä½¿ç”¨/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2018/03/06/Raspberry-PI-åŸºæœ¬ä½¿ç”¨/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-redux-ä¹‹é¡µé¢è·³è½¬" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2018/02/27/redux-ä¹‹é¡µé¢è·³è½¬/">redux ä¹‹é¡µé¢è·³è½¬</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2018/02/27/redux-ä¹‹é¡µé¢è·³è½¬/">
            <time datetime="2018-02-26T17:48:56.000Z" itemprop="datePublished">2018-02-26</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/RN/">RN</a>, <a class="tag-link" href="/blog/tags/redux/">redux</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>æœ€è¿‘æ­£åœ¨ç”¨ React Native é‡æ„æ•´ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬ç”¨äº† <strong><a href="https://github.com/krystofcelba/react-native-navigation#rn52" target="_blank" rel="noopener">react-native-navigation</a></strong> è¿™ä¸ªåº“æ¥ä½œä¸ºé¡¹ç›®çš„å¯¼èˆªæ§åˆ¶å™¨ã€‚<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¹³å¸¸ä¼šæŠŠé¡µé¢è·³è½¬é€»è¾‘çš„æ—¶å€™æ”¾åœ¨ Screen é‡Œé¢çš„ï¼Œæ¯”å¦‚:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FirstScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">    _someAction = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.props.navigator.push(&#123;</span><br><span class="line">          screen: <span class="string">'example.SecondScreen'</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    render = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„å†™æ³•æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ç›´åˆ°æˆ‘ä»¬ç¢°åˆ°è¿™æ ·ä¸€ä¸ªéœ€æ±‚çš„æ—¶å€™å°±æŠ“çäº†ï¼šç‚¹å‡»ä¸€ä¸ª PDF æ–‡ä»¶ï¼Œå¦‚æœ PDF æ–‡ä»¶æ²¡æœ‰ä¸‹è½½å°±å…ˆå»ä¸‹è½½ï¼Œä¸‹è½½å®Œæˆä¹‹åè‡ªåŠ¨è·³è½¬åˆ° PDF é˜…è¯»å™¨ã€‚ç”±äºç”¨äº† redux ä¹‹åï¼Œæˆ‘ä»¬å°±å¢åŠ ä¸€ä¸ª finished çš„ state æ¥åˆ¤æ–­æ˜¯å¦å·²ç»ä¸‹è½½å®Œæˆã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    componentWillReceiveProps = <span class="function">(<span class="params">nextProps</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œåˆ¤æ–­ä¸‹è½½çŠ¶æ€æ˜¯å¦å·²å®Œæˆï¼Œå®Œæˆçš„è¯å°±å»è·³è½¬</span></span><br><span class="line">        <span class="keyword">if</span> (nextProps.finished === <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="comment">// è¿™é‡Œéœ€è¦é‡ç½®ä¸€ä¸‹çŠ¶æ€ï¼Œä¸ç„¶å…¶ä»– state å‘ç”Ÿå˜åŒ–ä¼šå¤šæ¬¡è§¦å‘é¡µé¢çš„è·³è½¬</span></span><br><span class="line">            <span class="keyword">this</span>.props.dispatch(resetFinished());</span><br><span class="line">            <span class="keyword">this</span>.props.navigator.push(&#123;</span><br><span class="line">              screen: <span class="string">'example.PDFScreen'</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">    _someAction = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// openPDF() è¿™ä¸ª action ä¼šè‡ªåŠ¨å»ä¸‹è½½ PDF æ–‡ä»¶ï¼Œç„¶åä¿®æ”¹ finished çš„çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">this</span>.props.dispatch(openPDF());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    render = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function"><span class="params">state</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    finished: state.finished</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(ExampleScreen);</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„åšæ³•æ˜¯å¯ä»¥å®ç°æˆ‘ä»¬çš„éœ€æ±‚ï¼Œä½†æ˜¯è¿™ç§å†™æ³•å¾ˆè›‹ç–¼ã€‚å› ä¸ºå½“ä½ åœ¨è°ƒç”¨ç”¨ openPDF() çš„æ—¶å€™ï¼Œä½ ä»¥ä¸ºåé¢çš„äº‹ä¸éœ€è¦ä½ æ“å¿ƒï¼Œç„¶åè¿™ä¸ªæ—¶å€™æœ‰äººå‘Šè¯‰ä½ è¿˜éœ€è¦åœ¨å…¶ä»–åœ°æ–¹å¢åŠ ä¸€ä¸ªä¸­é—´çŠ¶æ€å»è¡¥å…… openPDF() çš„åç»­é€»è¾‘å¤„ç†ã€‚</p>
<p>ç»è¿‡è®¨è®ºä¹‹åï¼Œæˆ‘ä»¬å†³å®šæ”¹æˆç”¨ callback çš„æ–¹å¼æ¥å®ç°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç‚¹å‡»äº‹ä»¶</span></span><br><span class="line">    _someAction = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// openPDF() æ˜¯ä¸€ä¸ªå¼‚æ­¥ action</span></span><br><span class="line">        <span class="keyword">this</span>.props.dispatch(openPDF(callback: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.props.navigator.push(&#123;</span><br><span class="line">              screen: <span class="string">'example.PDFScreen'</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    render = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ callback çš„å¥½å¤„å°±æ˜¯å»æ‰äº†ä¸€ä¸ªçƒ¦äººçš„ä¸­é—´çŠ¶æ€ï¼Œå¹¶ä¸”ä»é˜…è¯»ä½“éªŒæ¥è¯´å¾ˆå®¹æ˜“è®©è¯»è€…æ˜ç™½è¿™ä¸ªç‚¹å‡»äº‹ä»¶åœ¨å¹²ä»€ä¹ˆã€‚ä½†æ˜¯åœ¨ redux çš„ action æ–¹æ³•ä¸­å¢åŠ ä¸€ä¸ª callback çš„è°ƒç”¨ï¼Œçœ‹èµ·æ¥ä¹Ÿæœ‰ç‚¹ä¸ä¼¦ä¸ç±»çš„ã€‚è™½ç„¶æˆ‘è®¤ä¸º callback å’Œå…¶ä»–å‚æ•°å…·æœ‰ç›¸åŒçš„æ³•å¾‹åœ°ä½ã€‚</p>
<p>å…¶å®æœ€å¥½çš„å®ç°æ˜¯ï¼Œè¿™ä¸ªç‚¹å‡»äº‹ä»¶åº”è¯¥è¿é¡µé¢çš„è·³è½¬é€»è¾‘ä¹Ÿä¸éœ€è¦å¤„ç†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç‚¹å‡»äº‹ä»¶ï¼Œè¿™ä¸ªäº‹ä»¶åªåšä¸€ä»¶äº‹å°±æ˜¯å» dispatch ä¸€ä¸ª openPDF() çš„ action</span></span><br><span class="line">    _someAction = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.props.dispatch(openPDF());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    render = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åƒä¸Šé¢è¿™ç§å®ç°ï¼Œæˆ‘ä»¬ä¹Ÿå°±åªèƒ½åœ¨ openPDF() é‡ŒåŠ¨æ‰‹è„šäº†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// action.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> openPDF = <span class="keyword">await</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">dispatch</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// å¼‚æ­¥ä¸‹è½½ PDF</span></span><br><span class="line">        <span class="keyword">async</span> downloadPDF();</span><br><span class="line">        <span class="comment">// å®Œæˆä¹‹åé€šè¿‡ router å»å®ç°é¡µé¢è·³è½¬</span></span><br><span class="line">        dispatch(openRouter(<span class="string">'PDFScreen'</span>));</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™é‡Œå°±ä¸å†è¯¦ç»†è¯´ router çš„å®ç°ç»†èŠ‚äº†ï¼Œå› ä¸ºç½‘ä¸Šæœ‰å¾ˆå¤šç°æˆçš„èµ„æ–™ã€‚ï¼ˆPS: ä¸»è¦æ˜¯æˆ‘ä¹Ÿè¿˜æ²¡çœ‹åˆ°è¿™ä¸€å—ï¼‰</p>
</blockquote>
<p>ä»é¡µé¢ï¼ˆScreenï¼‰çš„è§’åº¦æ¥è¯´ï¼Œæˆ‘è®¤ä¸ºè¿™æ ·çš„å¤„ç†æ˜¯æœ€åˆé€‚çš„ã€‚å› ä¸º Screen åªéœ€è¦å…³æ³¨æœ¬é¡µé¢çš„ state å’Œ actionï¼Œè‡³äºè·³è½¬çš„é€»è¾‘äº¤ç»™åé¢çš„ action æ¥å¤„ç†æ˜¯æœ€å¥½çš„ã€‚</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2018/02/27/redux-ä¹‹é¡µé¢è·³è½¬/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2018/02/27/redux-ä¹‹é¡µé¢è·³è½¬/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Swift-High-Performance-Tip 2ï¼šfinalå’Œprivate(fileprivate)" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2017/09/05/Swift-High-Performance-Tip 2ï¼šfinalå’Œprivate(fileprivate)/">Swift High-Performance Tip 2ï¼šfinal å’Œ private(fileprivate)</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2017/09/05/Swift-High-Performance-Tip 2ï¼šfinalå’Œprivate(fileprivate)/">
            <time datetime="2017-09-05T15:30:56.000Z" itemprop="datePublished">2017-09-05</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/Swift/">Swift</a>, <a class="tag-link" href="/blog/tags/iOS/">iOS</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <blockquote>
<p>Dynamic dispatch means that program has to determine at run time which method or property is being referred to and then perform an indirect call or indirect access.</p>
</blockquote>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ Swift çš„ class æ˜¯å¯ä»¥è¢«ç»§æ‰¿ï¼Œfunction å’Œ property æ˜¯å¯ä»¥è¢«é‡å†™çš„ï¼Œè€Œè¿™å°±æ„å‘³ç€ Swift éœ€è¦ dynamic dispatch è¿™ç§æœºåˆ¶æ¥å®Œæˆè¿™äº›åŠŸèƒ½ã€‚Swift çš„ dynamic dispatch é¦–å…ˆä¼šå† method table æŸ¥æ‰¾æ–¹æ³•ï¼Œç„¶åé—´æ¥è°ƒç”¨ã€‚å¾ˆæ˜æ˜¾è¿™ç§æ–¹å¼è¦æ¯”ç›´æ¥è°ƒç”¨çš„æ•ˆç‡æ…¢ï¼Œå¹¶ä¸”ç”¨é—´æ¥è°ƒç”¨çš„æ–¹å¼è¿˜ä¼šé˜»æ­¢ç¼–è¯‘å™¨çš„ä¸€äº›ä¼˜åŒ–æ— æ³•å®ç°ã€‚</p>
<p><strong>é‚£ä¹ˆåº”è¯¥æ€ä¹ˆä¼˜åŒ–å‘¢ï¼Ÿ</strong></p>
<p>å½“æˆ‘ä»¬æ˜ç¡®çš„çŸ¥é“ classã€functionã€property æ˜¯ä¸éœ€è¦ overriddenï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ final å’Œ private(fileprivate) è¿™äº›å…³é”®å­—å‡å°‘åŠ¨æ€æ´¾å‘çš„å‘ç”Ÿï¼Œä»è€Œæœ‰æ•ˆçš„æé«˜æ•ˆç‡ã€‚</p>
<p>åœ¨ Swift ä¸­ï¼Œå¦‚æœè¢« final æˆ– private(fileprivate) ä¿®é¥°çš„ classã€functionã€property æ˜¯ä¸èƒ½ overriddenï¼Œå¹¶ä¸”è°ƒç”¨è¿™äº› classã€functionã€property çš„æ—¶å€™ä¸å†é€šè¿‡ dynamic dispatch å»é—´æ¥è°ƒç”¨ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨ã€‚</p>
<p>æ‰€ä»¥ï¼Œé€šè¿‡åœ¨å¿…è¦çš„ä»£ç ä¸­ä½¿ç”¨ final æˆ– private(fileprivate) è¿™äº›å…³é”®å­—è¿›è¡Œä¼˜åŒ–çš„è¯ï¼Œå°†å¯ä»¥æœ‰æ•ˆæé«˜çš„æ•ˆç‡ã€‚</p>
<p><strong>Whole Module Optimization</strong></p>
<p>Swift çš„ classã€functionã€property çš„é»˜è®¤æƒé™éƒ½æ˜¯ internal ï¼Œé™¤éæˆ‘ä»¬æ˜ç¡®çš„åŠ ä¸Š public æˆ– private(fileprivate) å…³é”®å­—æ‰èƒ½æ”¹å˜å®ƒä»¬çš„é»˜è®¤æƒé™ã€‚</p>
<p>ç¼–è¯‘å™¨åœ¨ç¼–è¯‘ Module çš„æ—¶å€™éƒ½æ˜¯å¯¹é‡Œé¢çš„æºæ–‡ä»¶è¿›è¡Œå•ç‹¬ç¼–è¯‘ï¼Œè¿™æ ·çš„è¯ç¼–è¯‘å™¨å°±æ— æ³•ç¡®åˆ‡çš„çŸ¥é“è¢« internal ä¿®é¥°çš„ classã€functionã€property ç©¶ç«Ÿæœ‰æ²¡æœ‰è¢« overriddenã€‚ä¸€æ—¦æˆ‘ä»¬å¼€å¯ Whole Module Optimization çš„ä¼˜åŒ–é€‰é¡¹ï¼Œç¼–è¯‘å™¨å°±ä¼šåŒæ—¶å¯¹æ•´ä¸ª Module çš„æ‰€æœ‰æºæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œè¿™ä¸ªæ—¶å€™ç¼–è¯‘å™¨å°±å¯ä»¥çŸ¥é“å“ªäº›è¢« internal ä¿®é¥°çš„ classã€functionã€property æ²¡æœ‰è¢« overriddenï¼Œä»è€ŒæŠŠå®ƒä»¬çš„æƒé™ä» internal ä¿®æ”¹ä¸º finalã€‚è¿™æ ·çš„è¯ï¼Œå°±å¯ä»¥å‡å°‘ dynamic dispatch çš„å‘ç”Ÿä»è€Œæé«˜æ•ˆç‡ã€‚</p>
<p>å¼€å¯ç¼–è¯‘ä¼˜åŒ–é€‰é¡¹çš„æ­¥éª¤å¦‚ä¸‹ï¼šXcode -&gt; Build Settings -&gt; Swift Compiler -&gt; Optimization Levelã€‚</p>
<p><img src="http://i.imgur.com/0AxWEVA.jpg" alt=""></p>
<hr>
<p><strong>å‚è€ƒæ–‡çŒ®</strong></p>
<ol>
<li><p><a href="https://www.reddit.com/r/iOSProgramming/comments/3atu5w/does_swift_use_dynamic_method_dispatch_or_a/" target="_blank" rel="noopener">https://www.reddit.com/r/iOSProgramming/comments/3atu5w/does_swift_use_dynamic_method_dispatch_or_a/</a></p>
</li>
<li><p><a href="https://developer.apple.com/swift/blog/?id=27" target="_blank" rel="noopener">https://developer.apple.com/swift/blog/?id=27</a></p>
</li>
<li><p><a href="https://github.com/apple/swift/blob/3ef6c79e3c591cf31b8a853b1357e1b8c5771252/docs/OptimizationTips.rst#whole-module-optimizations" target="_blank" rel="noopener">https://github.com/apple/swift/blob/3ef6c79e3c591cf31b8a853b1357e1b8c5771252/docs/OptimizationTips.rst#whole-module-optimizations</a></p>
</li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2017/09/05/Swift-High-Performance-Tip 2ï¼šfinalå’Œprivate(fileprivate)/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2017/09/05/Swift-High-Performance-Tip 2ï¼šfinalå’Œprivate(fileprivate)/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Vim-Tip" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/blog/2017/09/05/Vim-Tip/">Vim Tip</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/blog/2017/09/05/Vim-Tip/">
            <time datetime="2017-09-05T15:30:56.000Z" itemprop="datePublished">2017-09-05</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/blog/tags/tip/">tip</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="1ã€æ›¿æ¢ç¬¬n1è¡Œåˆ°ç¬¬n2è¡Œçš„å†…å®¹"><a href="#1ã€æ›¿æ¢ç¬¬n1è¡Œåˆ°ç¬¬n2è¡Œçš„å†…å®¹" class="headerlink" title="1ã€æ›¿æ¢ç¬¬n1è¡Œåˆ°ç¬¬n2è¡Œçš„å†…å®¹"></a>1ã€æ›¿æ¢ç¬¬n1è¡Œåˆ°ç¬¬n2è¡Œçš„å†…å®¹</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:n1,n2/origin/replace/g</span><br></pre></td></tr></table></figure>
<h2 id="2ã€æ›¿æ¢æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹"><a href="#2ã€æ›¿æ¢æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹" class="headerlink" title="2ã€æ›¿æ¢æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹"></a>2ã€æ›¿æ¢æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:%s/origin/replace/g</span><br></pre></td></tr></table></figure>
<h2 id="3ã€ç§»åŠ¨n1-n2è¡Œ-åŒ…æ‹¬n1-n2-åˆ°n3è¡Œä¹‹ä¸‹"><a href="#3ã€ç§»åŠ¨n1-n2è¡Œ-åŒ…æ‹¬n1-n2-åˆ°n3è¡Œä¹‹ä¸‹" class="headerlink" title="3ã€ç§»åŠ¨n1-n2è¡Œ(åŒ…æ‹¬n1,n2)åˆ°n3è¡Œä¹‹ä¸‹"></a>3ã€ç§»åŠ¨n1-n2è¡Œ(åŒ…æ‹¬n1,n2)åˆ°n3è¡Œä¹‹ä¸‹</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n1,n2 <span class="keyword">m</span> n3</span><br></pre></td></tr></table></figure>
<h2 id="4ã€å¤åˆ¶n1-n2è¡Œ-åŒ…æ‹¬n1-n2-åˆ°n3è¡Œä¹‹ä¸‹"><a href="#4ã€å¤åˆ¶n1-n2è¡Œ-åŒ…æ‹¬n1-n2-åˆ°n3è¡Œä¹‹ä¸‹" class="headerlink" title="4ã€å¤åˆ¶n1-n2è¡Œ(åŒ…æ‹¬n1,n2)åˆ°n3è¡Œä¹‹ä¸‹"></a>4ã€å¤åˆ¶n1-n2è¡Œ(åŒ…æ‹¬n1,n2)åˆ°n3è¡Œä¹‹ä¸‹</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:n1,n2 <span class="keyword">co</span> n3</span><br></pre></td></tr></table></figure>
<h2 id="5ã€åˆ é™¤æ–‡ä»¶çš„ç©ºè¡Œ"><a href="#5ã€åˆ é™¤æ–‡ä»¶çš„ç©ºè¡Œ" class="headerlink" title="5ã€åˆ é™¤æ–‡ä»¶çš„ç©ºè¡Œ"></a>5ã€åˆ é™¤æ–‡ä»¶çš„ç©ºè¡Œ</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:g/^$/d</span><br></pre></td></tr></table></figure>
<h2 id="6ã€åœ¨æ–‡æœ¬ä¸­æ’å…¥ä¸€ä¸ª1åˆ°100çš„åºåˆ—ï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰"><a href="#6ã€åœ¨æ–‡æœ¬ä¸­æ’å…¥ä¸€ä¸ª1åˆ°100çš„åºåˆ—ï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰" class="headerlink" title="6ã€åœ¨æ–‡æœ¬ä¸­æ’å…¥ä¸€ä¸ª1åˆ°100çš„åºåˆ—ï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰"></a>6ã€åœ¨æ–‡æœ¬ä¸­æ’å…¥ä¸€ä¸ª1åˆ°100çš„åºåˆ—ï¼ˆæ¥è‡ªæ± è€å¸ˆ<a href="http://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=2650712546&amp;idx=1&amp;sn=c4db99547b75d6001b3cfaa6cbc0e715&amp;scene=1&amp;srcid=0805j7ny3Ua1WufWDEpnhwOG#rd" target="_blank" rel="noopener">ã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹</a>ï¼‰</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:r!seq <span class="number">100</span></span><br></pre></td></tr></table></figure>
<h2 id="7ã€åœ¨å½“å‰çš„æ¯ä¸€è¡Œæ–‡å­—å‰é¢å¢åŠ â€œåºå·-â€ï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰"><a href="#7ã€åœ¨å½“å‰çš„æ¯ä¸€è¡Œæ–‡å­—å‰é¢å¢åŠ â€œåºå·-â€ï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰" class="headerlink" title="7ã€åœ¨å½“å‰çš„æ¯ä¸€è¡Œæ–‡å­—å‰é¢å¢åŠ â€œåºå·. â€ï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰"></a>7ã€åœ¨å½“å‰çš„æ¯ä¸€è¡Œæ–‡å­—å‰é¢å¢åŠ â€œåºå·. â€ï¼ˆæ¥è‡ªæ± è€å¸ˆ<a href="http://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=2650712546&amp;idx=1&amp;sn=c4db99547b75d6001b3cfaa6cbc0e715&amp;scene=1&amp;srcid=0805j7ny3Ua1WufWDEpnhwOG#rd" target="_blank" rel="noopener">ã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹</a>ï¼‰</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:<span class="keyword">let</span> i=<span class="number">1</span> | g /^/ s//\=i.<span class="string">". "</span>/ | <span class="keyword">let</span> i+=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="8ã€å½“å‰ç›®å½•ä¸‹ï¼ˆåŒ…æ‹¬å­æ–‡ä»¶å¤¹ï¼‰æ‰€æœ‰åç¼€ä¸º-java-çš„æ–‡ä»¶ä¸­çš„-apache-æ›¿æ¢æˆ-eclipseï¼Œé‚£ä¹ˆåœ¨å½“å‰ç›®å½•ä¸‹ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰"><a href="#8ã€å½“å‰ç›®å½•ä¸‹ï¼ˆåŒ…æ‹¬å­æ–‡ä»¶å¤¹ï¼‰æ‰€æœ‰åç¼€ä¸º-java-çš„æ–‡ä»¶ä¸­çš„-apache-æ›¿æ¢æˆ-eclipseï¼Œé‚£ä¹ˆåœ¨å½“å‰ç›®å½•ä¸‹ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰" class="headerlink" title="8ã€å½“å‰ç›®å½•ä¸‹ï¼ˆåŒ…æ‹¬å­æ–‡ä»¶å¤¹ï¼‰æ‰€æœ‰åç¼€ä¸º java çš„æ–‡ä»¶ä¸­çš„ apache æ›¿æ¢æˆ eclipseï¼Œé‚£ä¹ˆåœ¨å½“å‰ç›®å½•ä¸‹ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šï¼ˆæ¥è‡ªæ± è€å¸ˆã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹ï¼‰"></a>8ã€å½“å‰ç›®å½•ä¸‹ï¼ˆåŒ…æ‹¬å­æ–‡ä»¶å¤¹ï¼‰æ‰€æœ‰åç¼€ä¸º java çš„æ–‡ä»¶ä¸­çš„ apache æ›¿æ¢æˆ eclipseï¼Œé‚£ä¹ˆåœ¨å½“å‰ç›®å½•ä¸‹ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šï¼ˆæ¥è‡ªæ± è€å¸ˆ<a href="http://mp.weixin.qq.com/s?__biz=MjM5ODQ2MDIyMA==&amp;mid=2650712546&amp;idx=1&amp;sn=c4db99547b75d6001b3cfaa6cbc0e715&amp;scene=1&amp;srcid=0805j7ny3Ua1WufWDEpnhwOG#rd" target="_blank" rel="noopener">ã€Šè¯´ï¼Œè°æ‰æ˜¯æœ€å¸…çš„ç¼–ç¨‹å·¥å…·ï¼Ÿã€‹</a>ï¼‰</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">vim</span></span><br><span class="line">:n **/*.java</span><br><span class="line">:<span class="keyword">argdo</span> %s/apache/eclipse/ge | <span class="keyword">update</span></span><br></pre></td></tr></table></figure>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="https://hparis.github.io/blog/2017/09/05/Vim-Tip/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://hparis.github.io/blog/2017/09/05/Vim-Tip/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/blog/page/2/">2</a><a class="extend next" rel="next" href="/blog/page/2/">Next &raquo;</a>
    </nav>
</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">recent</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/blog/2018/05/25/Swift-High-Performance-Tip 3ï¼š @objc-å’Œ-dynamic/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a></p>
                            <p class="item-title"><a href="/blog/2018/05/25/Swift-High-Performance-Tip 3ï¼š @objc-å’Œ-dynamic/" class="title">Swift High-Performance Tip 3ï¼š@objc å’Œ dynamic</a></p>
                            <p class="item-date"><time datetime="2018-05-24T18:48:01.000Z" itemprop="datePublished">2018-05-24</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/blog/2018/04/19/self-åœ¨-block-ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–/" class="thumbnail">
    
    
        <span style="background-image:url(https://images.unsplash.com/photo-1462303966430-8a4708fd729e?ixlib=rb-0.3.5&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;s=c9dd0952e673c518403fb8d4c28f93b5&amp;auto=format&amp;fit=crop&amp;w=160&amp;q=60)" alt="self åœ¨ block ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a></p>
                            <p class="item-title"><a href="/blog/2018/04/19/self-åœ¨-block-ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–/" class="title">self åœ¨ block ä¸­çš„å¼•ç”¨è®¡æ•°å˜åŒ–</a></p>
                            <p class="item-date"><time datetime="2018-04-19T11:34:51.000Z" itemprop="datePublished">2018-04-19</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/blog/2018/04/09/å¸¸ç”¨å·¥å…·/" class="thumbnail">
    
    
        <span style="background-image:url(https://images.unsplash.com/photo-1514443031610-8c063c7a9822?ixlib=rb-0.3.5&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;s=73d9a7ce5ba0ed22cb91bdc0506ac9d0&amp;auto=format&amp;fit=crop&amp;w=160&amp;q=10)" alt="å¸¸ç”¨å·¥å…·" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a></p>
                            <p class="item-title"><a href="/blog/2018/04/09/å¸¸ç”¨å·¥å…·/" class="title">å¸¸ç”¨å·¥å…·</a></p>
                            <p class="item-date"><time datetime="2018-04-09T02:53:18.333Z" itemprop="datePublished">2018-04-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/blog/2018/04/02/å¦‚ä½•ç”¨-Objective-C-å®ç°ä¸€ä¸ªæ­»é”/" class="thumbnail">
    
    
        <span style="background-image:url(https://images.unsplash.com/photo-1509655172625-03265ba919a1?ixlib=rb-0.3.5&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;s=24b01fba0d86b9fa95814c692429379f&amp;auto=format&amp;fit=crop&amp;w=160&amp;q=100)" alt="å¦‚ä½•ç”¨ Objective-C å®ç°ä¸€ä¸ªæ­»é”" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a></p>
                            <p class="item-title"><a href="/blog/2018/04/02/å¦‚ä½•ç”¨-Objective-C-å®ç°ä¸€ä¸ªæ­»é”/" class="title">å¦‚ä½•ç”¨ Objective-C å®ç°ä¸€ä¸ªæ­»é”</a></p>
                            <p class="item-date"><time datetime="2018-04-01T20:29:42.000Z" itemprop="datePublished">2018-04-01</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/blog/2018/03/24/è¯´è¯´-Objective-C-ä¸­çš„-Copy-æ“ä½œ/" class="thumbnail">
    
    
        <span style="background-image:url(https://i.imgur.com/svn3AbQs.png)" alt="è¯´è¯´ Objective-C ä¸­çš„ Copy æ“ä½œ" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a></p>
                            <p class="item-title"><a href="/blog/2018/03/24/è¯´è¯´-Objective-C-ä¸­çš„-Copy-æ“ä½œ/" class="title">è¯´è¯´ Objective-C ä¸­çš„ Copy æ“ä½œ</a></p>
                            <p class="item-date"><time datetime="2018-03-23T16:35:55.000Z" itemprop="datePublished">2018-03-23</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/Raspberry-PI/">Raspberry PI</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/æŠ€æœ¯/">æŠ€æœ¯</a><span class="category-list-count">14</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/05/">May 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/04/">April 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/03/">March 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2017/09/">September 2017</a><span class="archive-list-count">7</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tags</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Block/">Block</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/GCD/">GCD</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Objective-C/">Objective-C</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/RAC/">RAC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/RN/">RN</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Raspberry-PI/">Raspberry PI</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/Swift/">Swift</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/iOS/">iOS</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/redux/">redux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/tip/">tip</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/å…¶ä»–/">å…¶ä»–</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/blog/tags/Block/" style="font-size: 10px;">Block</a> <a href="/blog/tags/GCD/" style="font-size: 13.33px;">GCD</a> <a href="/blog/tags/Objective-C/" style="font-size: 16.67px;">Objective-C</a> <a href="/blog/tags/RAC/" style="font-size: 10px;">RAC</a> <a href="/blog/tags/RN/" style="font-size: 13.33px;">RN</a> <a href="/blog/tags/Raspberry-PI/" style="font-size: 10px;">Raspberry PI</a> <a href="/blog/tags/Swift/" style="font-size: 16.67px;">Swift</a> <a href="/blog/tags/iOS/" style="font-size: 20px;">iOS</a> <a href="/blog/tags/redux/" style="font-size: 10px;">redux</a> <a href="/blog/tags/tip/" style="font-size: 13.33px;">tip</a> <a href="/blog/tags/å…¶ä»–/" style="font-size: 10px;">å…¶ä»–</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2018 å¸•å¸•<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_config = function () {
        
        this.page.identifier = '';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'pariscode' + '.disqus.com/count.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>




    
        <script src="/blog/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/blog/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/blog/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/blog/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/blog/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/blog/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/blog/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/blog/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/blog/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/blog/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/blog/js/main.js"></script>

    </div>
</body>
</html>