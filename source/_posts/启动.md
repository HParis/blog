---
layout: post 
title: 计算机的启动过程
subtitle: 记录自己的理解
author: 帕帕
date: 2017-09-05 15:30:56 +0800
categories: 技术 
tags: [其他]
---

一、启动

1. 启动电源
2. CPU(只能执行指令，不能保存指令，它的指令全存在内存中)去内存地址 0xFFFFFFF0 找到第一条需要执行的指令（跳转指令）
3. 跳转到 BIOS 系统，运行 BIOS 的一大堆指令，只要是做系统自检（硬盘、内存、显卡等）。如果有问题会通过喇叭声音的长短组合进行提示
4. BIOS 在自检之后生成中断向量表
5. 当 BIOS 的所有工作都完成之后，会给 CPU 发送一条中断指令，比如 `int 0x19`
6. CPU 接到中断指令之后就去中断向量表找到第 19 号对应的一大堆指令
7. 这堆指令主要是把磁盘的第一扇区（磁盘最开始的 512 Byte）的数据运到内存中，之后 CPU 就开始执行这些指令
8. 这些精巧的指令会把 OS(操作系统) 从磁盘运到内存中

二、运行

1. OS 进入内存之后，立刻就是老大
2. OS 告诉 CPU 开始运行 A 程序
3. CPU 会去硬盘把 A 程序装载到内存中，CPU 才能执行 A 程序的指令
4. 如果此时 OS 告诉 CPU 去执行 B 程序，那么 CPU 会保存好现场，然后去执行 B 程序的指令

三、缓存

1. 因为硬盘的读写速度太慢了，所以都需要先把硬盘的数据装载到内存中之后，CPU 再去内存取指令来执行
2. 但是内存的读写速度依旧还是要比 CPU 慢，一旦指令多起来之后内存的读写速度也会让 CPU 觉得受不了
3. 经过一段时间的运行之后，我们会发现 CPU 去内存取指令是有规律的，这个规律叫**程序的局部性原理**。CPU 在访问一个内存位置以后过不多久还会多次访问；一个内存位置被访问了， 附近的位置很快也会访问到。
4. CPU 需要读写指令和数据的时候直接从缓存要，如果缓存没有才会去找内存
5. 局部性原理在程序切换之后，缓存就会失效。因为两个程序之间没什么联系，局部性原理就不起作用了，所以需要重建缓存。

四、流水线

1. CPU 在计算的过程分成四个步骤：从内存读取指令 - 翻译指令 - 执行 - 把结果写回内存（该步骤有时候没有）
2. CPU 可以同时执行上面四个步骤，比如：

```
读取指令 A
读取指令 B - 翻译指令 A
读取指令 C - 翻译指令 B - 执行指令 C
读取指令 D - 翻译指令 C - 执行指令 B - 把指令 A 的结果写回内存
```

---
参考文献：

1. https://mp.weixin.qq.com/s?__biz=MzAxOTc0NzExNg==&mid=2665513017&idx=1&sn=5550ee714abd36d0b580713f673e670b&scene=21#wechat_redirect


